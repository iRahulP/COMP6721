<!DOCTYPE html><html lang="en"><head><link href="//fonts.googleapis.com" rel="preconnect"/><link href="//fonts.gstatic.com" rel="preconnect" crossorigin="true"/><link href="//cdnjs.cloudflare.com" rel="preconnect"/><link href="//s3.stackabuse.com" rel="preconnect"/><link href="//googletagservices.com" rel="dns-prefetch"/><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="HandheldFriendly" content="True"/><link rel="shortcut icon" href="/assets/images/favicon.ico"/><link rel="apple-touch-icon" sizes="180x180" href="/assets/images/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicon-16x16.png"/><link rel="preload" as="style" href="//fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&amp;display=swap"/><link rel="preload" as="style" href="//fonts.googleapis.com/css?family=Nunito:400,400i,700,700i&amp;display=swap"/><meta name="referrer" content="no-referrer-when-downgrade"/><link rel="alternate" type="application/rss+xml" title="Stack Abuse" href="https://stackabuse.com/rss/"/><script defer="" src="//cdnjs.cloudflare.com/ajax/libs/autotrack/1.0.1/autotrack.js"></script><script>
                        !function(f,b,e,v,n,t,s)
                        {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
                        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
                        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
                        n.queue=[];t=b.createElement(e);t.async=!0;
                        t.src=v;s=b.getElementsByTagName(e)[0];
                        s.parentNode.insertBefore(t,s)}(window, document,'script',
                        'https://connect.facebook.net/en_US/fbevents.js');
                        fbq('init', '525232124909042');
                        fbq('track', 'PageView');
                    </script><noscript>
                        <img height="1" width="1" style="display:none"
                          src="https://www.facebook.com/tr?id=525232124909042&ev=PageView&noscript=1"
                        />
                    </noscript><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link href="//cdn.thisiswaldo.com" rel="preconnect"/><title>Minimax with Alpha-Beta Pruning in Python</title><meta property="og:site_name" content="Stack Abuse"/><meta property="og:type" content="article"/><meta property="og:title" content="Minimax with Alpha-Beta Pruning in Python"/><meta property="og:description" content="Way back in the late 1920s John Von Neumann established the main problem in game theory that has remained relevant still today:  Players s1, s2, ..., sn are pl..."/><meta property="og:url" content="https://stackabuse.com/minimax-and-alpha-beta-pruning-in-python/"/><meta property="article:published_time" content="2019-08-26T12:25:00Z"/><meta property="article:modified_time" content="2019-08-26T16:18:02Z"/><meta property="article:tag" content="python"/><meta property="article:tag" content="artificial intelligence"/><meta property="article:tag" content="algorithms"/><meta property="article:tag" content="game theory"/><meta property="article:publisher" content="https://stackabuse.com"/><meta property="article:author" content="https://twitter.com"/><meta name="description" content="Way back in the late 1920s John Von Neumann established the main problem in game theory that has remained relevant still today:  Players s1, s2, ..., sn are pl..."/><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Minimax with Alpha-Beta Pruning in Python"/><meta name="twitter:description" content="Way back in the late 1920s John Von Neumann established the main problem in game theory that has remained relevant still today:  Players s1, s2, ..., sn are pl..."/><meta name="twitter:url" content="https://stackabuse.com/minimax-and-alpha-beta-pruning-in-python/"/><meta name="twitter:site" content="@StackAbuse"/><meta name="twitter:creator" content="@StackAbuse"/><meta name="twitter:label1" content="Written by"/><meta name="twitter:data1" content="Mina Krivokuƒáa"/><meta name="twitter:label2" content="Filed under"/><meta name="twitter:data2" content="python, artificial intelligence, algorithms, game theory"/><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "publisher": {
    "@type": "Organization",
    "name": "Stack Abuse",
    "logo": {
      "@type": "ImageObject",
      "url": "https://stackabuse.com/favicon.png"
    }
  },
  "headline": "Minimax with Alpha-Beta Pruning in Python",
  "url": "https://stackabuse.com/minimax-and-alpha-beta-pruning-in-python/",
  "image": {
    "@type": "ImageObject",
    "url": null
  },
  "description": "Way back in the late 1920s John Von Neumann established the main problem in game theory that has remained relevant still today:  Players s1, s2, ..., sn are pl...",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://stackabuse.com/"
  },
  "author": {
    "@type": "Person",
    "name": "Mina Krivokuƒáa",
    "image": {
      "@type": "ImageObject",
      "url": "https://s3.stackabuse.com/media/users/7c916203e7c1ddff49eed8c7063b1164.jpg"
    },
    "url": "https://stackabuse.com/author/minx/",
    "sameAs": [
      "https://facebook.com",
      "https://twitter.com",
      "https://github.com"
    ]
  }
}</script><link rel="canonical" href="https://stackabuse.com/minimax-and-alpha-beta-pruning-in-python/"/><script defer="" src="//cdn.thisiswaldo.com/static/js/3873.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript" defer=""></script><meta name="next-head-count" content="32"/><link rel="preload" href="/_next/static/css/a796ce71f4e223d4cb88.css" as="style"/><link rel="stylesheet" href="/_next/static/css/a796ce71f4e223d4cb88.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/webpack-277c75ec70a3d22a400d.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework-c8764b7c89156c961b8d.js" as="script"/><link rel="preload" href="/_next/static/chunks/main-518b48f042719025b17a.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-9c13ffeead0b88cdb1b4.js" as="script"/><link rel="preload" href="/_next/static/chunks/3-fffb48dea4989f4d1391.js" as="script"/><link rel="preload" href="/_next/static/chunks/543-cb07b5fc2817d1fd9d2f.js" as="script"/><link rel="preload" href="/_next/static/chunks/638-590762dd8d0272f0797c.js" as="script"/><link rel="preload" href="/_next/static/chunks/677-73df68294d1ef6988d75.js" as="script"/><link rel="preload" href="/_next/static/chunks/566-946cc7c83528800c6af6.js" as="script"/><link rel="preload" href="/_next/static/chunks/221-fd1b1d9fc7fde140cafc.js" as="script"/><link rel="preload" href="/_next/static/chunks/489-460cf565e04b6b9db7ae.js" as="script"/><link rel="preload" href="/_next/static/chunks/458-83f6a55e72287e88ba6c.js" as="script"/><link rel="preload" href="/_next/static/chunks/917-3ebc564d49985eea0f5b.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/%5Bslug%5D-5a81b17152fa06d8cc4d.js" as="script"/></head><body><div id="__next"><nav class="bg-white"><div class="max-w-7xl mx-auto px-2 sm:px-4 lg:px-8"><div class="flex justify-between h-16"><div class="flex items-center px-2 lg:px-0"><a href="/"><div class="flex-shrink-0 flex items-center"><div style="background-color:#404040" class="logo rounded-md p-3"><div class="leading-5 font-bold" style="font-size:30px;color:#dddddd">Stack<!-- --> <span style="color:#f16334">Abuse</span></div></div></div></a><div class="hidden lg:block lg:ml-6"><div class="hidden lg:ml-6 lg:flex"><a class="inline-flex items-center px-1 pt-1 border-b-2 border-yellow-200 text-sm font-medium leading-10 text-gray-900 hover:text-gray-700 hover:border-gray-300 focus:outline-none focus:text-gray-700 focus:border-gray-300 transition duration-150 ease-in-out" href="/tag/python/">Python</a><a class="ml-8 inline-flex items-center px-1 pt-1 border-b-2 border-green-400 text-sm font-medium leading-10 text-gray-500 hover:text-gray-700 hover:border-gray-300 focus:outline-none focus:text-gray-700 focus:border-gray-300 transition duration-150 ease-in-out" href="/tag/javascript/">JavaScript</a><a class="ml-8 inline-flex items-center px-1 pt-1 border-b-2 border-red-500 text-sm font-medium leading-10 text-gray-500 hover:text-gray-700 hover:border-gray-300 focus:outline-none focus:text-gray-700 focus:border-gray-300 transition duration-150 ease-in-out" href="/tag/java/">Java</a></div></div></div><div class="hidden md:flex md:flex-1 md:items-center md:justify-center md:px-2 lg:ml-6 lg:justify-end"><div class="relative w-1/2 mt-4 text-gray-400 transition duration-200 focus-within:text-gray-600"><div class="absolute inset-y-0 left-0 flex items-center pointer-events-none" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="h-5 w-5 ml-2" aria-hidden="true"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"></path></svg></div><input type="text" id="search-field" class="block w-full h-full pl-10 pr-3 py-3 text-sm border-gray-300 text-gray-900 placeholder-gray-500 rounded transition duration-200 focus:outline-none focus:ring-0 focus:border-gray-400" placeholder="Search"/></div></div><div class="flex items-center lg:hidden"><button class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 focus:text-gray-500 transition duration-150 ease-in-out" aria-label="Main menu" aria-expanded="false"><svg class="block h-6 w-6" stroke="currentColor" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg><svg class="hidden h-6 w-6" stroke="currentColor" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div></div></div><div class="hidden lg:hidden"><div class="pt-2 pb-3"><a class="mt-1 block pl-3 pr-4 py-2 border-l-4 border-transparent text-base font-medium text-gray-600 hover:text-gray-800 hover:bg-gray-50 hover:border-gray-300 focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300 transition duration-150 ease-in-out" href="/tag/python/">Python</a><a class="mt-1 block pl-3 pr-4 py-2 border-l-4 border-transparent text-base font-medium text-gray-600 hover:text-gray-800 hover:bg-gray-50 hover:border-gray-300 focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300 transition duration-150 ease-in-out" href="/tag/javascript/">JavaScript</a><a class="mt-1 block pl-3 pr-4 py-2 border-l-4 border-transparent text-base font-medium text-gray-600 hover:text-gray-800 hover:bg-gray-50 hover:border-gray-300 focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300 transition duration-150 ease-in-out" href="/tag/java/">Java</a></div></div></nav><main class="bg-gray-50"><div class="mt-6 pb-6"><div class="grid grid-cols-12 gap-4 pt-8 text-gray-200" style="background-color:#404040"><div class="col-span-1"></div><div class="col-span-10"><div class="hidden sm:flex items-center text-sm leading-5 font-medium"><a class="text-gray-400 hover:text-gray-100 transition duration-150 ease-in-out" href="/">Home</a><svg class="flex-shrink-0 mx-2 h-5 w-5 text-gray-500" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg><span class="text-gray-400">Articles</span></div><div class="py-2"><h1 class="text-3xl font-bold leading-7 sm:text-4xl sm:leading-9">Minimax with Alpha-Beta Pruning in Python</h1><div class="flex items-center mt-4"><div><img class="inline-block h-8 w-8 rounded-full ring-2 ring-gray-200" src="//s3.stackabuse.com/media/users/7c916203e7c1ddff49eed8c7063b1164.jpg" alt=""/></div><div class="ml-4"><a class="text-gray-300 hover:text-gray-100" href="/author/minx/">Mina Krivokuƒáa</a></div><div></div></div></div></div></div><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 65"><path fill="#404040" fill-opacity="1" d="M0,64L60,53.3C120,43,240,21,360,10.7C480,0,600,0,720,10.7C840,21,960,43,1080,48C1200,53,1320,43,1380,37.3L1440,32L1440,0L1380,0C1320,0,1200,0,1080,0C960,0,840,0,720,0C600,0,480,0,360,0C240,0,120,0,60,0L0,0Z"></path></svg><div class="grid grid-cols-1 md:grid-cols-24 mx-2 md:mx-0 md:ml-8 md:gap-8"><div class="hidden md:block lg:col-span-2"></div><div class="col-span-14"><div><div class=" my-4 flex justify-center" style="min-height:90px"><div id="waldo-tag-3878"></div></div><noscript><style>.lazyload-placeholder { display: none; }</style></noscript><div class="content"><html><head></head><body><h3 id="introduction">Introduction</h3>
<p>Way back in the late 1920s <a rel="nofollow" target="_blank" href="https://en.wikipedia.org/wiki/John_von_Neumann">John Von Neumann</a> established the main problem in game theory that has remained relevant still today:</p>
<blockquote>
<p>Players s<sub>1</sub>, s<sub>2</sub>, ..., s<sub>n</sub> are playing a given game G. Which moves should player s<sub>m</sub> play to achieve the best possible outcome?</p>
</blockquote>
<p>Shortly after, problems of this kind grew into a challenge of great significance for development of one of today's most popular fields in computer science - artificial intelligence. Some of the greatest accomplishments in artificial intelligence are achieved on the subject of strategic games - world champions in various strategic games have already been beaten by computers, e.g. in Chess, Checkers, Backgammon, and most recently (2016) even Go.</p>
<p>Although these programs are very successful, their way of making decisions is a lot different than that of humans. The majority of these programs are based on efficient <a target="_blank" href="/search-algorithms-in-python">searching algorithms</a>, and since recently on machine learning as well.</p>
<p>The <a rel="nofollow" target="_blank" href="https://en.wikipedia.org/wiki/Minimax">Minimax algorithm</a> is a relatively simple algorithm used for optimal decision-making in game theory and artificial intelligence. Again, since these algorithms heavily rely on being efficient, the vanilla algorithm's performance can be heavily improved by using alpha-beta pruning - we'll cover both in this article.</p>
<p>Although we won't analyze each game individually, we'll briefly explain some general concepts that are relevant for two-player <a rel="nofollow" target="_blank" href="https://en.wikipedia.org/wiki/Non-cooperative_game_theory">non-cooperative</a> <a rel="nofollow" target="_blank" href="https://en.wikipedia.org/wiki/Zero-sum_game">zero-sum</a> <a rel="nofollow" target="_blank" href="https://en.wikipedia.org/wiki/Symmetric_game">symmetrical</a> games with <a rel="nofollow" target="_blank" href="https://en.wikipedia.org/wiki/Perfect_information">perfect information</a> - Chess, Go, Tic-Tac-Toe, Backgammon, Reversi, Checkers, Mancala, 4 in a row etc...</p>
<p>As you probably noticed, none of these games are ones where e.g. a player doesn't know which cards the opponent has, or where a player needs to guess about certain information.</p>
<h3 id="definingterms">Defining Terms</h3>
<p>Rules of many of these games are defined by <em>legal positions</em> (or <em>legal states</em>) and <em>legal moves</em> for every legal position. For every legal position it is possible to effectively determine all the legal moves. Some of the legal positions are <em>starting positions</em> and some are <em>ending positions</em>.</p>
<p>The best way to describe these terms is using a tree graph whose nodes are legal positions and whose edges are legal moves. The graph is directed since it does not necessarily mean that we'll be able to move back exactly where we came from in the previous move, e.g. in chess a pawn can only go forward. This graph is called a <em>game tree</em>. Moving down the game tree represents one of the players making a move, and the game state changing from one legal position to another.</p>
<div id="ad-content-1"><div class=" my-4 flex justify-center" style="min-height:250px"><div id="waldo-tag-10946"></div></div></div><p>Here's an illustration of a game tree for a tic-tac-toe game:</p>
<p><div id="lazy-img-0"><div class="lazyload-wrapper " data-reactroot=""><div style="height:24rem" class="lazyload-placeholder"></div></div><noscript data-reactroot=""><img class="" src="https://stackabuse.s3.amazonaws.com/media/minimax-and-alpha-beta-pruning-in-python-1.png" alt=""/></noscript></div></p>
<p>Grids colored blue are player X's turns, and grids colored red are player O's turns. The ending position (leaf of the tree) is any grid where one of the players won or the board is full and there's no winner.</p>
<p>The <em>complete game tree</em> is a game tree whose root is starting position, and all the leaves are ending positions. Each complete game tree has as many nodes as the game has possible outcomes for every legal move made. It is easy to notice that even for small games like tic-tac-toe the complete game tree is huge. For that reason it is not a good practice to explicitly create a whole game tree as a structure while writing a program that is supposed to predict the best move at any moment. Yet, the nodes should be created implicitly in the process of visiting.</p>
<p>We'll define <em>state-space complexity of a game</em> as a number of legal game positions reachable from the starting position of the game, and <em>branching factor</em> as the number of children at each node (if that number isn't constant, it's a common practice to use an average).</p>
<p>For tic-tac-toe, an upper bound for the size of the state space is 3<sup>9</sup>=19683. Imagine that number for games like chess! Hence, searching through whole tree to find out what's our best move whenever we take turn would be super inefficient and slow.</p>
<p>This is why Minimax is of such a great significance in game theory.</p>
<h3 id="theorybehindminimax">Theory Behind Minimax</h3>
<p>The Minimax algorithm relies on systematic searching, or more accurately said - on <strong>brute force</strong> and a simple evaluation function. Let's assume that every time during deciding the next move we search through a whole tree, all the way down to leaves. Effectively we would look into all the possible outcomes and every time we would be able to determine the best possible move.</p>
<p>However, for non-trivial games, that practice is inapplicable. Even searching to a certain depth sometimes takes an unacceptable amount of time. Therefore, Minimax applies search to a fairly low tree depth aided with appropriate <a rel="nofollow" target="_blank" href="https://en.wikipedia.org/wiki/Heuristic">heuristics</a>, and a well designed, yet simple <em>evaluation function</em>.</p>
<p>With this approach we lose the certainty in finding the best possible move, but the majority of cases the decision that minimax makes is much better than any human's.</p>
<p>Now, let's take a closer look at the evaluation function we've previously mentioned. In order to determine a good (not necessarily the best) move for a certain player, we have to somehow evaluate nodes (positions) to be able to compare one to another by quality.</p>
<blockquote>
<p>The evaluation function is a static number, that in accordance with the characteristics of the game itself, is being assigned to each node (position).</p>
</blockquote>
<p>It is important to mention that the evaluation function must not rely on the search of previous nodes, nor of the following. It should simply analyze the game state and circumstances that both players are in.</p>
<p>It is necessary that the evaluation function contains as much relevant information as possible, but on the other hand - since it's being calculated <strong>many</strong> times - it needs to be simple.</p>
<p>Usually it maps the set of all possible positions into symmetrical segment:</p>
<p>$$<br>
\mathcal{F} : \mathcal{P} \rightarrow [-M, M]<br>
$$</p>
<p>Value of <code>M</code> is being assigned only to leaves where the winner is the first player, and value <code>-M</code> to leaves where the winner is the second player.</p>
<p>In zero-sum games, the value of the evaluation function has an opposite meaning - what's better for the first player is worse for the second, and vice versa. Hence, the value for symmetric positions (if players switch roles) should be different only by sign.</p>
<div id="ad-content-2"><div class=" my-4 flex justify-center" style="min-height:250px"><div id="waldo-tag-3880"></div></div></div><p>A common practice is to modify evaluations of leaves by subtracting the depth of that exact leaf, so that out of all moves that lead to victory the algorithm can pick the one that does it in the smallest number of steps (or picks the move that postpones loss if it is inevitable).</p>
<p>Here's a simple illustration of Minimax' steps. We're looking for the minimum value, in this case.</p>
<p>The green layer calls the <code>Max()</code> method on nodes in the child nodes and the red layer calls the <code>Min()</code> method on child nodes.</p>
<ol>
<li>Evaluating leaves:</li>
</ol>
<p><div id="lazy-img-1"><div class="lazyload-wrapper " data-reactroot=""><div style="height:24rem" class="lazyload-placeholder"></div></div><noscript data-reactroot=""><img class="" src="https://stackabuse.s3.amazonaws.com/media/minimax-and-alpha-beta-pruning-in-python-2.png" alt=""/></noscript></div></p>
<ol start="2">
<li>Deciding the best move for green player using depth 3:</li>
</ol>
<p><div id="lazy-img-2"><div class="lazyload-wrapper " data-reactroot=""><div style="height:24rem" class="lazyload-placeholder"></div></div><noscript data-reactroot=""><img class="" src="https://stackabuse.s3.amazonaws.com/media/minimax-and-alpha-beta-pruning-in-python-3.png" alt=""/></noscript></div></p>
<p>The idea is to find the best possible move for a given node, depth, and evaluation function.</p>
<p>In this example we've assumed that the green player seeks positive values, while the pink player seeks negative. The algorithm primarily evaluates only nodes at the given depth, and the rest of the procedure is <a rel="nofollow" target="_blank" href="https://en.wikipedia.org/wiki/Recursion_(computer_science)">recursive</a>. The values of the rest of the nodes are the maximum values of their respective children if it's green player's turn, or, analogously, the minimum value if it's pink player's turn. The value in each node represents the next best move considering given information.</p>
<p>While searching the game tree, we're examining only nodes on a fixed (given) depth, not the ones before, nor after. This phenomenon is often called <a rel="nofollow" target="_blank" href="https://en.wikipedia.org/wiki/Horizon_effect">the horizon effect</a>.</p>
<h3 id="openingbooksandtictactoe">Opening Books and Tic-Tac-Toe</h3>
<p>In strategic games, instead of letting the program start the searching process in the very beginning of the game, it is common to use the <em>opening books</em> - a list of known and productive moves that are frequent and known to be productive while we still don't have much information about the state of game itself if we look at the board.</p>
<p>In the beginning, it is too early in the game, and the number of potential positions is too great to automatically decide which move will certainly lead to a better game state (or win).</p>
<p>However, the algorithm reevaluates the next potential moves every turn, always choosing what at that moment appears to be the fastest route to victory. Therefore, it won't execute actions that take more than one move to complete, and is unable to perform certain well known "tricks" because of that. If the AI plays against a human, it is very likely that human will immediately be able to prevent this.</p>
<p>If, on the other hand, we take a look at chess, we'll quickly realize the impracticality of solving chess by brute forcing through a whole game tree. To demonstrate this, <a rel="nofollow" target="_blank" href="https://en.wikipedia.org/wiki/Claude_Shannon">Claude Shannon</a> calculated the lower bound of the game-tree complexity of chess, resulting in about <strong>10<sup>120</sup> possible games</strong>.</p>
<p>Just how big is that number? For reference, if we compared the mass of an electron (10<sup>-30</sup>kg) to the mass of the <em>entire known universe</em> (10<sup>50</sup>-10<sup>60</sup>kg), the ratio would be in order of 10<sup>80</sup>-10<sup>90</sup>.</p>
<p>That's ~0.0000000000000000000000000000000001% of the Shannon number.</p>
<p>Imagine tasking an algorithm to go through <em>every single</em> of those combinations just to make a single decision. It's practically impossible to do.</p>
<p>Even after 10 moves, the number of possible games is tremendously huge:</p>
<table class="table table-striped" style="white-space:nowrap; font-size:15px;">
  <tbody><tr>
    <th>Number of moves</th>
    <th>Number of possible games</th>
  </tr>
  <tr>
    <td>1</td>
    <td>20</td>
  </tr>
  <tr>
    <td>2</td>
    <td>40</td>
  </tr>
  <tr>
    <td>3</td>
    <td>8,902</td>
  </tr>
  <tr>
    <td>4</td>
    <td>197,281</td>
  </tr>
  <tr>
    <td>5</td>
    <td>4,865,609</td>
  </tr>
  <tr>
    <td>6</td>
    <td>119,060,324</td>
  </tr>
  <tr>
    <td>7</td>
    <td>3,195,901,860</td>
  </tr>
  <tr>
    <td>8</td>
    <td>84,998,978,956</td>
  </tr>
  <tr>
    <td>9</td>
    <td>2,439,530,234,167</td>
  </tr>
  <tr>
    <td>10</td>
    <td>69,352,859,712,417</td>
  </tr>
</tbody></table>
<div id="ad-lead-magnet"><div class="mx-auto pt-3 pb-4 mb-4 lg:mb-2 lg:pt-4 lg:pb-5"><div class="bg-gray-100 px-4 py-1 rounded-lg shadow-lg border border-gray-400 md:py-2 md:px-6 lg:py-3 lg:px-8 flex items-center flex-col xl:flex-row"><div class="xl:pt-2 w-1/2 xs:w-full sm:mx-auto"><div class="lazyload-wrapper "><div style="height:300px" class="lazyload-placeholder"></div></div></div><div class="mt-2 w-full sm:max-w-xl xl:mt-0 xl:ml-8 sm:w-2/3 sm:mx-auto"><h2 class="mt-2 mb-1 text-xl leading-4 font-extrabold tracking-tight text-gray-600 sm:text-2xl sm:leading-6 sm:text-center">Free eBook: Git Essentials</h2><p class="mt-3 max-w-3xl text-md leading-6 text-gray-500 sm:text-center">Check out our hands-on, practical guide to learning Git, with best-practices, industry-accepted standards, and included cheat sheet. Stop Googling Git commands and actually <em>learn</em> it!</p><div class="mt-4 flex sm:justify-center sm:mx-auto"><div class="ml-3 xl:inline-flex rounded-md shadow"><button class="inline-flex items-center justify-center px-3 py-1 bg-orange-400 border border-transparent text-base leading-6 font-medium rounded-md hover:bg-orange-500 hover:no-underline focus:outline-none focus:ring transition duration-150 ease-in-out"><span class="inline-flex items-center text-white">Download the eBook<!-- --> &nbsp;<svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></span></button></div></div></div></div></div></div><p>Let's take this example to a tic-tac-toe game. As you probably already know, the most famous strategy of player X is to start in any of the corners, which gives the player O the most opportunities to make a mistake. If player O plays anything besides center and X continues his initial strategy, it's a guaranteed win for X. Opening books are exactly this - some nice ways to trick an opponent in the very beginning to get advantage, or in best case, a win.</p>
<p>To simplify the code and get to the core of algorithm, in the example in the next chapter we won't bother using opening books or any mind tricks. We'll let the minimax search from the start, so don't be surprised that algorithm never recommends the corner strategy.</p>
<h3 id="minimaximplementationinpython">Minimax Implementation in Python</h3>
<p>In the code below, we will be using an evaluation function that is fairly simple and common for all games in which it's possible to search the whole tree, all the way down to leaves.</p>
<p>It has 3 possible values:</p>
<ul>
<li>-1 if player that seeks minimum wins</li>
<li>0 if it's a tie</li>
<li>1 if player that seeks maximum wins</li>
</ul>
<p>Since we'll be implementing this through a tic-tac-toe game, let's go through the building blocks. First, let's make a constructor and draw out the board:</p>
<pre><code class="hljs"><span class="hljs-comment"># We'll use the time module to measure the time of evaluating</span>
<span class="hljs-comment"># game tree in every move. It's a nice way to show the</span>
<span class="hljs-comment"># distinction between the basic Minimax and Minimax with</span>
<span class="hljs-comment"># alpha-beta pruning :)</span>
<span class="hljs-keyword">import</span> time

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Game</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span>
        self.initialize_game()

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">initialize_game</span>(<span class="hljs-params">self</span>):</span>
        self.current_state = [[<span class="hljs-string">'.'</span>,<span class="hljs-string">'.'</span>,<span class="hljs-string">'.'</span>],
                              [<span class="hljs-string">'.'</span>,<span class="hljs-string">'.'</span>,<span class="hljs-string">'.'</span>],
                              [<span class="hljs-string">'.'</span>,<span class="hljs-string">'.'</span>,<span class="hljs-string">'.'</span>]]

        <span class="hljs-comment"># Player X always plays first</span>
        self.player_turn = <span class="hljs-string">'X'</span>

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">draw_board</span>(<span class="hljs-params">self</span>):</span>
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>):
            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>):
                print(<span class="hljs-string">'{}|'</span>.<span class="hljs-built_in">format</span>(self.current_state[i][j]), end=<span class="hljs-string">" "</span>)
            print()
        print()
</code></pre>
<p>We've talked about <em>legal moves</em> in the beginning sections of the article. To make sure we abide by the rules, we need a way to check if a move is legal:</p>
<pre><code class="hljs"><span class="hljs-comment"># Determines if the made move is a legal move</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_valid</span>(<span class="hljs-params">self, px, py</span>):</span>
    <span class="hljs-keyword">if</span> px &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> px &gt; <span class="hljs-number">2</span> <span class="hljs-keyword">or</span> py &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> py &gt; <span class="hljs-number">2</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
    <span class="hljs-keyword">elif</span> self.current_state[px][py] != <span class="hljs-string">'.'</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
</code></pre>
<p>Then, we need a simple way to check if the game has ended. In tic-tac-toe, a player can win by connecting three consecutive symbols in either a horizontal, diagonal or vertical line:</p>
<pre><code class="hljs"><span class="hljs-comment"># Checks if the game has ended and returns the winner in each case</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">is_end</span>(<span class="hljs-params">self</span>):</span>
    <span class="hljs-comment"># Vertical win</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>):
        <span class="hljs-keyword">if</span> (self.current_state[<span class="hljs-number">0</span>][i] != <span class="hljs-string">'.'</span> <span class="hljs-keyword">and</span>
            self.current_state[<span class="hljs-number">0</span>][i] == self.current_state[<span class="hljs-number">1</span>][i] <span class="hljs-keyword">and</span>
            self.current_state[<span class="hljs-number">1</span>][i] == self.current_state[<span class="hljs-number">2</span>][i]):
            <span class="hljs-keyword">return</span> self.current_state[<span class="hljs-number">0</span>][i]

    <span class="hljs-comment"># Horizontal win</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>):
        <span class="hljs-keyword">if</span> (self.current_state[i] == [<span class="hljs-string">'X'</span>, <span class="hljs-string">'X'</span>, <span class="hljs-string">'X'</span>]):
            <span class="hljs-keyword">return</span> <span class="hljs-string">'X'</span>
        <span class="hljs-keyword">elif</span> (self.current_state[i] == [<span class="hljs-string">'O'</span>, <span class="hljs-string">'O'</span>, <span class="hljs-string">'O'</span>]):
            <span class="hljs-keyword">return</span> <span class="hljs-string">'O'</span>

    <span class="hljs-comment"># Main diagonal win</span>
    <span class="hljs-keyword">if</span> (self.current_state[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] != <span class="hljs-string">'.'</span> <span class="hljs-keyword">and</span>
        self.current_state[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] == self.current_state[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>] <span class="hljs-keyword">and</span>
        self.current_state[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] == self.current_state[<span class="hljs-number">2</span>][<span class="hljs-number">2</span>]):
        <span class="hljs-keyword">return</span> self.current_state[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]

    <span class="hljs-comment"># Second diagonal win</span>
    <span class="hljs-keyword">if</span> (self.current_state[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>] != <span class="hljs-string">'.'</span> <span class="hljs-keyword">and</span>
        self.current_state[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>] == self.current_state[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>] <span class="hljs-keyword">and</span>
        self.current_state[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>] == self.current_state[<span class="hljs-number">2</span>][<span class="hljs-number">0</span>]):
        <span class="hljs-keyword">return</span> self.current_state[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>]

    <span class="hljs-comment"># Is whole board full?</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>):
        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>):
            <span class="hljs-comment"># There's an empty field, we continue the game</span>
            <span class="hljs-keyword">if</span> (self.current_state[i][j] == <span class="hljs-string">'.'</span>):
                <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>

    <span class="hljs-comment"># It's a tie!</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">'.'</span>
</code></pre>
<p>The AI we play against is seeking two things - to maximize its own score and to minimize ours. To do that, we'll have a <code>max()</code> method that the AI uses for making optimal decisions.</p>
<pre><code class="hljs"><span class="hljs-comment"># Player 'O' is max, in this case AI</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">max</span>(<span class="hljs-params">self</span>):</span>

    <span class="hljs-comment"># Possible values for maxv are:</span>
    <span class="hljs-comment"># -1 - loss</span>
    <span class="hljs-comment"># 0  - a tie</span>
    <span class="hljs-comment"># 1  - win</span>

    <span class="hljs-comment"># We're initially setting it to -2 as worse than the worst case:</span>
    maxv = -<span class="hljs-number">2</span>

    px = <span class="hljs-literal">None</span>
    py = <span class="hljs-literal">None</span>

    result = self.is_end()

    <span class="hljs-comment"># If the game came to an end, the function needs to return</span>
    <span class="hljs-comment"># the evaluation function of the end. That can be:</span>
    <span class="hljs-comment"># -1 - loss</span>
    <span class="hljs-comment"># 0  - a tie</span>
    <span class="hljs-comment"># 1  - win</span>
    <span class="hljs-keyword">if</span> result == <span class="hljs-string">'X'</span>:
        <span class="hljs-keyword">return</span> (-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)
    <span class="hljs-keyword">elif</span> result == <span class="hljs-string">'O'</span>:
        <span class="hljs-keyword">return</span> (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)
    <span class="hljs-keyword">elif</span> result == <span class="hljs-string">'.'</span>:
        <span class="hljs-keyword">return</span> (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)

    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>):
        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>):
            <span class="hljs-keyword">if</span> self.current_state[i][j] == <span class="hljs-string">'.'</span>:
                <span class="hljs-comment"># On the empty field player 'O' makes a move and calls Min</span>
                <span class="hljs-comment"># That's one branch of the game tree.</span>
                self.current_state[i][j] = <span class="hljs-string">'O'</span>
                (m, min_i, min_j) = self.<span class="hljs-built_in">min</span>()
                <span class="hljs-comment"># Fixing the maxv value if needed</span>
                <span class="hljs-keyword">if</span> m &gt; maxv:
                    maxv = m
                    px = i
                    py = j
                <span class="hljs-comment"># Setting back the field to empty</span>
                self.current_state[i][j] = <span class="hljs-string">'.'</span>
    <span class="hljs-keyword">return</span> (maxv, px, py)
</code></pre>
<p>However, we will also include a <code>min()</code> method that will serve as a helper for us to minimize the AI's score:</p>
<pre><code class="hljs"><span class="hljs-comment"># Player 'X' is min, in this case human</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">min</span>(<span class="hljs-params">self</span>):</span>

    <span class="hljs-comment"># Possible values for minv are:</span>
    <span class="hljs-comment"># -1 - win</span>
    <span class="hljs-comment"># 0  - a tie</span>
    <span class="hljs-comment"># 1  - loss</span>

    <span class="hljs-comment"># We're initially setting it to 2 as worse than the worst case:</span>
    minv = <span class="hljs-number">2</span>

    qx = <span class="hljs-literal">None</span>
    qy = <span class="hljs-literal">None</span>

    result = self.is_end()

    <span class="hljs-keyword">if</span> result == <span class="hljs-string">'X'</span>:
        <span class="hljs-keyword">return</span> (-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)
    <span class="hljs-keyword">elif</span> result == <span class="hljs-string">'O'</span>:
        <span class="hljs-keyword">return</span> (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)
    <span class="hljs-keyword">elif</span> result == <span class="hljs-string">'.'</span>:
        <span class="hljs-keyword">return</span> (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)

    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>):
        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>):
            <span class="hljs-keyword">if</span> self.current_state[i][j] == <span class="hljs-string">'.'</span>:
                self.current_state[i][j] = <span class="hljs-string">'X'</span>
                (m, max_i, max_j) = self.<span class="hljs-built_in">max</span>()
                <span class="hljs-keyword">if</span> m &lt; minv:
                    minv = m
                    qx = i
                    qy = j
                self.current_state[i][j] = <span class="hljs-string">'.'</span>

    <span class="hljs-keyword">return</span> (minv, qx, qy)
</code></pre>
<p>And ultimately, let's make a game loop that allows us to play against the AI:</p>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">play</span>(<span class="hljs-params">self</span>):</span>
    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
        self.draw_board()
        self.result = self.is_end()

        <span class="hljs-comment"># Printing the appropriate message if the game has ended</span>
        <span class="hljs-keyword">if</span> self.result != <span class="hljs-literal">None</span>:
            <span class="hljs-keyword">if</span> self.result == <span class="hljs-string">'X'</span>:
                print(<span class="hljs-string">'The winner is X!'</span>)
            <span class="hljs-keyword">elif</span> self.result == <span class="hljs-string">'O'</span>:
                print(<span class="hljs-string">'The winner is O!'</span>)
            <span class="hljs-keyword">elif</span> self.result == <span class="hljs-string">'.'</span>:
                print(<span class="hljs-string">"It's a tie!"</span>)

            self.initialize_game()
            <span class="hljs-keyword">return</span>

        <span class="hljs-comment"># If it's player's turn</span>
        <span class="hljs-keyword">if</span> self.player_turn == <span class="hljs-string">'X'</span>:

            <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:

                start = time.time()
                (m, qx, qy) = self.<span class="hljs-built_in">min</span>()
                end = time.time()
                print(<span class="hljs-string">'Evaluation time: {}s'</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">round</span>(end - start, <span class="hljs-number">7</span>)))
                print(<span class="hljs-string">'Recommended move: X = {}, Y = {}'</span>.<span class="hljs-built_in">format</span>(qx, qy))

                px = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">'Insert the X coordinate: '</span>))
                py = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">'Insert the Y coordinate: '</span>))

                (qx, qy) = (px, py)

                <span class="hljs-keyword">if</span> self.is_valid(px, py):
                    self.current_state[px][py] = <span class="hljs-string">'X'</span>
                    self.player_turn = <span class="hljs-string">'O'</span>
                    <span class="hljs-keyword">break</span>
                <span class="hljs-keyword">else</span>:
                    print(<span class="hljs-string">'The move is not valid! Try again.'</span>)

        <span class="hljs-comment"># If it's AI's turn</span>
        <span class="hljs-keyword">else</span>:
            (m, px, py) = self.<span class="hljs-built_in">max</span>()
            self.current_state[px][py] = <span class="hljs-string">'O'</span>
            self.player_turn = <span class="hljs-string">'X'</span>
</code></pre>
<div id="ad-content-3"><div class=" my-4 flex justify-center" style="min-height:250px"><div id="waldo-tag-3884"></div></div></div><p>Let's start the game!</p>
<pre><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span>
    g = Game()
    g.play()

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    main()
</code></pre>
<p>Now we'll take a look at what happens when we follow the recommended sequence of turns - i.e. we play optimally:</p>
<pre><code class="hljs">.| .| .|
.| .| .|
.| .| .|

Evaluation time: 5.0726919s
Recommended move: X = 0, Y = 0
Insert the X coordinate: 0
Insert the Y coordinate: 0
X| .| .|
.| .| .|
.| .| .|

X| .| .|
.| O| .|
.| .| .|

Evaluation time: 0.06496s
Recommended move: X = 0, Y = 1
Insert the X coordinate: 0
Insert the Y coordinate: 1
X| X| .|
.| O| .|
.| .| .|

X| X| O|
.| O| .|
.| .| .|

Evaluation time: 0.0020001s
Recommended move: X = 2, Y = 0
Insert the X coordinate: 2
Insert the Y coordinate: 0
X| X| O|
.| O| .|
X| .| .|

X| X| O|
O| O| .|
X| .| .|

Evaluation time: 0.0s
Recommended move: X = 1, Y = 2
Insert the X coordinate: 1
Insert the Y coordinate: 2
X| X| O|
O| O| X|
X| .| .|

X| X| O|
O| O| X|
X| O| .|

Evaluation time: 0.0s
Recommended move: X = 2, Y = 2
Insert the X coordinate: 2
Insert the Y coordinate: 2
X| X| O|
O| O| X|
X| O| X|

It's a tie!
</code></pre>
<p>As you've noticed, winning against this kind of AI is impossible. If we assume that both player and AI are playing optimally, the game will always be a tie. Since the AI always plays optimally, if we slip up, we'll lose.</p>
<p>Take a close look at the evaluation time, as we will compare it to the next, improved version of the algorithm in the next example.</p>
<h3 id="alphabetapruning">Alpha-Beta Pruning</h3>
<p><strong>Alpha‚Äìbeta (ùõº‚àíùõΩ)</strong> algorithm was discovered independently by a few researches in mid 1900s. Alpha‚Äìbeta is actually an improved minimax using a heuristic. It stops evaluating a move when it makes sure that it's worse than previously examined move. Such moves need not to be evaluated further.</p>
<p>When added to a simple minimax algorithm, it gives the same output, but cuts off certain branches that can't possibly affect the final decision - dramatically improving the performance.</p>
<p>The main concept is to maintain two values through whole search:</p>
<ul>
<li><strong>Alpha</strong>: Best already explored option for player Max</li>
<li><strong>Beta</strong>: Best already explored option for player Min</li>
</ul>
<p>Initially, alpha is negative infinity and beta is positive infinity, i.e. in our code we'll be using the worst possible scores for both players.</p>
<p>Let's see how the previous tree will look if we apply alpha-beta method:</p>
<p><div id="lazy-img-3"><div class="lazyload-wrapper " data-reactroot=""><div style="height:24rem" class="lazyload-placeholder"></div></div><noscript data-reactroot=""><img class="" src="https://stackabuse.s3.amazonaws.com/media/minimax-and-alpha-beta-pruning-in-python-4.png" alt=""/></noscript></div></p>
<p>When the search comes to the first grey area (8), it'll check the current best (with minimum value) already explored option along the path for the minimizer, which is at that moment 7. Since 8 is bigger than 7, we are allowed to cut off all the further children of the node we're at (in this case there aren't any), since if we play that move, the opponent will play a move with value 8, which is worse for us than any possible move the opponent could have made if we had made another move.</p>
<p>A better example may be when it comes to a next grey. Note the nodes with value -9. At that point, the best (with maximum value) explored option along the path for the maximizer is -4. Since -9 is less than -4, we are able to cut off all the other children of the node we're at.</p>
<p>This method allows us to ignore many branches that lead to values that won't be of any help for our decision, nor they would affect it in any way.</p>
<p>With that in mind, let's modify the <code>min()</code> and <code>max()</code> methods from before:</p>
<div id="ad-content-4"><div class=" my-4 flex justify-center" style="min-height:250px"><div id="waldo-tag-10947"></div></div></div><pre><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">max_alpha_beta</span>(<span class="hljs-params">self, alpha, beta</span>):</span>
        maxv = -<span class="hljs-number">2</span>
        px = <span class="hljs-literal">None</span>
        py = <span class="hljs-literal">None</span>

        result = self.is_end()

        <span class="hljs-keyword">if</span> result == <span class="hljs-string">'X'</span>:
            <span class="hljs-keyword">return</span> (-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)
        <span class="hljs-keyword">elif</span> result == <span class="hljs-string">'O'</span>:
            <span class="hljs-keyword">return</span> (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)
        <span class="hljs-keyword">elif</span> result == <span class="hljs-string">'.'</span>:
            <span class="hljs-keyword">return</span> (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)

        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>):
            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>):
                <span class="hljs-keyword">if</span> self.current_state[i][j] == <span class="hljs-string">'.'</span>:
                    self.current_state[i][j] = <span class="hljs-string">'O'</span>
                    (m, min_i, in_j) = self.min_alpha_beta(alpha, beta)
                    <span class="hljs-keyword">if</span> m &gt; maxv:
                        maxv = m
                        px = i
                        py = j
                    self.current_state[i][j] = <span class="hljs-string">'.'</span>

                    <span class="hljs-comment"># Next two ifs in Max and Min are the only difference between regular algorithm and minimax</span>
                    <span class="hljs-keyword">if</span> maxv &gt;= beta:
                        <span class="hljs-keyword">return</span> (maxv, px, py)

                    <span class="hljs-keyword">if</span> maxv &gt; alpha:
                        alpha = maxv

        <span class="hljs-keyword">return</span> (maxv, px, py)
</code></pre>
<pre><code class="hljs"> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">min_alpha_beta</span>(<span class="hljs-params">self, alpha, beta</span>):</span>

        minv = <span class="hljs-number">2</span>

        qx = <span class="hljs-literal">None</span>
        qy = <span class="hljs-literal">None</span>

        result = self.is_end()

        <span class="hljs-keyword">if</span> result == <span class="hljs-string">'X'</span>:
            <span class="hljs-keyword">return</span> (-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)
        <span class="hljs-keyword">elif</span> result == <span class="hljs-string">'O'</span>:
            <span class="hljs-keyword">return</span> (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)
        <span class="hljs-keyword">elif</span> result == <span class="hljs-string">'.'</span>:
            <span class="hljs-keyword">return</span> (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)

        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>):
            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>):
                <span class="hljs-keyword">if</span> self.current_state[i][j] == <span class="hljs-string">'.'</span>:
                    self.current_state[i][j] = <span class="hljs-string">'X'</span>
                    (m, max_i, max_j) = self.max_alpha_beta(alpha, beta)
                    <span class="hljs-keyword">if</span> m &lt; minv:
                        minv = m
                        qx = i
                        qy = j
                    self.current_state[i][j] = <span class="hljs-string">'.'</span>

                    <span class="hljs-keyword">if</span> minv &lt;= alpha:
                        <span class="hljs-keyword">return</span> (minv, qx, qy)

                    <span class="hljs-keyword">if</span> minv &lt; beta:
                        beta = minv

        <span class="hljs-keyword">return</span> (minv, qx, qy)
</code></pre>
<p>And now, the game loop:</p>
<pre><code class="hljs">  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">play_alpha_beta</span>(<span class="hljs-params">self</span>):</span>
     <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
        self.draw_board()
        self.result = self.is_end()

        <span class="hljs-keyword">if</span> self.result != <span class="hljs-literal">None</span>:
            <span class="hljs-keyword">if</span> self.result == <span class="hljs-string">'X'</span>:
                print(<span class="hljs-string">'The winner is X!'</span>)
            <span class="hljs-keyword">elif</span> self.result == <span class="hljs-string">'O'</span>:
                print(<span class="hljs-string">'The winner is O!'</span>)
            <span class="hljs-keyword">elif</span> self.result == <span class="hljs-string">'.'</span>:
                print(<span class="hljs-string">"It's a tie!"</span>)


            self.initialize_game()
            <span class="hljs-keyword">return</span>

        <span class="hljs-keyword">if</span> self.player_turn == <span class="hljs-string">'X'</span>:

            <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
                start = time.time()
                (m, qx, qy) = self.min_alpha_beta(-<span class="hljs-number">2</span>, <span class="hljs-number">2</span>)
                end = time.time()
                print(<span class="hljs-string">'Evaluation time: {}s'</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">round</span>(end - start, <span class="hljs-number">7</span>)))
                print(<span class="hljs-string">'Recommended move: X = {}, Y = {}'</span>.<span class="hljs-built_in">format</span>(qx, qy))

                px = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">'Insert the X coordinate: '</span>))
                py = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">'Insert the Y coordinate: '</span>))

                qx = px
                qy = py

                <span class="hljs-keyword">if</span> self.is_valid(px, py):
                    self.current_state[px][py] = <span class="hljs-string">'X'</span>
                    self.player_turn = <span class="hljs-string">'O'</span>
                    <span class="hljs-keyword">break</span>
                <span class="hljs-keyword">else</span>:
                    print(<span class="hljs-string">'The move is not valid! Try again.'</span>)

        <span class="hljs-keyword">else</span>:
            (m, px, py) = self.max_alpha_beta(-<span class="hljs-number">2</span>, <span class="hljs-number">2</span>)
            self.current_state[px][py] = <span class="hljs-string">'O'</span>
            self.player_turn = <span class="hljs-string">'X'</span>
</code></pre>
<p>Playing the game is the same as before, though if we take a look at the time it takes for the AI to find optimal solutions, there's a big difference:</p>
<pre><code class="hljs">.| .| .|
.| .| .|
.| .| .|

Evaluation time: 0.1688969s
Recommended move: X = 0, Y = 0


Evaluation time: 0.0069957s
Recommended move: X = 0, Y = 1


Evaluation time: 0.0009975s
Recommended move: X = 2, Y = 0


Evaluation time: 0.0s
Recommended move: X = 1, Y = 2


Evaluation time: 0.0s
Recommended move: X = 2, Y = 2

It's a tie!
</code></pre>
<p>After testing and starting the program from scratch for a few times, results for the comparison are in a table below:</p>
<table class="table table-striped" style="white-space:nowrap; font-size:15px;">
  <tbody><tr>
    <th>Algorithm</th>
    <th>Minimum time</th>
    <th>Maximum time</th>
  </tr>
  <tr>
    <td>Minimax</td>
    <td>4.57s</td>
    <td>5.34s</td>
  </tr>
  <tr>
    <td>Alpha-beta pruning</td>
    <td>0.16s</td>
    <td>0.2s</td>
  </tr>
</tbody></table>
<h3 id="conclusion">Conclusion</h3>
<p>Alpha-beta pruning makes a major difference in evaluating large and complex game trees. Even though tic-tac-toe is a simple game itself, we can still notice how without alpha-beta heuristics the algorithm takes significantly more time to recommend the move in first turn.</p>
</body></html></div><div></div><div class="md:flex md:items-center md:justify-between mt-8 mb-4"><div class=""><a class="inline-flex items-center mr-2 px-2.5 py-0.5 rounded-md text-sm font-medium bg-gray-200 text-gray-700 hover:text-gray-900" href="/tag/python/"><span class="text-gray-400">#</span> <!-- -->python</a><a class="inline-flex items-center mr-2 px-2.5 py-0.5 rounded-md text-sm font-medium bg-gray-200 text-gray-700 hover:text-gray-900" href="/tag/artificial-intelligence/"><span class="text-gray-400">#</span> <!-- -->artificial intelligence</a><a class="inline-flex items-center mr-2 px-2.5 py-0.5 rounded-md text-sm font-medium bg-gray-200 text-gray-700 hover:text-gray-900" href="/tag/algorithms/"><span class="text-gray-400">#</span> <!-- -->algorithms</a><a class="inline-flex items-center mr-2 px-2.5 py-0.5 rounded-md text-sm font-medium bg-gray-200 text-gray-700 hover:text-gray-900" href="/tag/game-theory/"><span class="text-gray-400">#</span> <!-- -->game theory</a></div><div class="inline-flex text-gray-500 text-sm"><div>Last Updated: <!-- -->August 26th, 2019</div></div></div><div class="w-full lg:w-1/3 border-gray-200" style="border-top-width:6px"></div><div class="md:flex md:items-center md:justify-between py-2"><div class="flex items-center text-sm text-gray-500"><span class="mr-2">Was this article helpful?</span><div class="flex"><span class="cursor-pointer"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path></svg></span><span class="cursor-pointer"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path></svg></span><span class="cursor-pointer"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path></svg></span><span class="cursor-pointer"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path></svg></span><span class="cursor-pointer"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path></svg></span></div></div><div class="inline-flex"><a href="https://twitter.com/share?text=Check out Minimax with Alpha-Beta Pruning in Python!&amp;amp;url=https://stackabuse.com/minimax-and-alpha-beta-pruning-in-python/&amp;amp;via=StackAbuse"><svg class="h-6 w-6 text-gray-500 hover:text-twitter" fill="currentColor" viewBox="0 0 24 24"><path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84"></path></svg></a><a href="https://www.facebook.com/sharer/sharer.php?u=https://stackabuse.com/minimax-and-alpha-beta-pruning-in-python/"><svg class="h-6 w-6 ml-2 text-gray-500 hover:text-facebook" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.988C18.343 21.128 22 16.991 22 12z" clip-rule="evenodd"></path></svg></a><a href="/cdn-cgi/l/email-protection#c1feb2b4a3aba4a2b5fc8ca8afa8aca0b9e1b6a8b5a9e180adb1a9a0ec83a4b5a0e191b3b4afa8afa6e1a8afe191b8b5a9aeafe1b7a8a0e192b5a0a2aa80a3b4b2a4efa2aeace7a0acb1faa0acb1faa3aea5b8fc82a9a4a2aae1aeb4b5e1b5a9a4e1a0b3b5a8a2ada4e1a9b5b5b1b2fbeeeeb2b5a0a2aaa0a3b4b2a4efa2aeaceeaca8afa8aca0b9eca0afa5eca0adb1a9a0eca3a4b5a0ecb1b3b4afa8afa6eca8afecb1b8b5a9aeafeee1aeafe192b5a0a2aa80a3b4b2a4efa2aeace0"><svg class="h-6 w-6 ml-2 text-gray-500 hover:text-gray-900" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207"></path></svg></a></div></div></div><div><div><div class="max-w-6xl mx-auto px-0 py-6 lg:py-8"><div class="px-6 py-6 rounded-lg md:py-12 md:px-8 lg:py-16 lg:px-10 xl:flex xl:items-center xl:justify-between grid grid-cols-1 xl:grid-cols-2" style="background-color:#404040"><div class=""><h2 class="text-2xl font-extrabold tracking-tight text-white sm:text-3xl">Improve your dev skills!</h2><p class="mt-3 max-w-3xl text-lg leading-6 text-gray-200">Get tutorials, guides, and dev jobs in your inbox.</p></div><div class="mt-8 sm:w-full sm:max-w-md xl:mt-0 xl:ml-8"><form class="sm:flex"><label for="email-address" class="sr-only">Email address</label><input type="email" id="email-address" autoComplete="email" required="" class="w-full border-white px-3 py-3 placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-offset-1 focus:ring-offset-gray-500 focus:ring-white rounded-md" placeholder="Enter your email" value=""/><button type="submit" class="mt-3 w-full flex items-center justify-center px-5 py-3 border border-transparent shadow text-base font-medium rounded-md text-white hover:bg-orange-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-orange-700 focus:ring-white sm:mt-0 sm:ml-3 sm:w-auto sm:flex-shrink-0" style="background-color:#f16334">Sign Up</button></form><p class="mt-3 text-sm text-gray-300">No spam ever. Unsubscribe at any time. Read our<!-- --> <a class="font-medium underline" href="/privacy-policy/"><span class="text-gray-400">Privacy Policy.</span></a></p></div></div></div></div><div class="flex content-start flex-wrap"><div class="mt-12"><div class="flex items-center"><div class="flex-shrink-0"><a href="/author/minx/"><div class="lazyload-wrapper "><div style="height:5rem" class="lazyload-placeholder"></div></div></a></div><div class="ml-3"><a class="font-medium text-lg leading-6" href="/author/minx/"><span class="text-gray-900">Mina Krivokuƒáa</span></a><span class="ml-2 text-sm leading-5 text-gray-500 italic">Author</span><div class="flex content-start flex-wrap"></div><div class="mt-4"><div></div></div></div></div></div></div><div class="flex content-start flex-wrap"></div></div><div class="sm:mt-12 sm:p-3 sm:border-2"><div class="lazyload-wrapper "><div style="height:800px" class="lazyload-placeholder"></div></div></div></div><div class="col-span-7"><div class="pb-4"><div class=" my-4 flex justify-center" style="min-height:250px"><div id="waldo-tag-3874"></div></div></div><div class="hidden md:block py-4"><h2 class="my-2 text-sm leading-4 font-extrabold text-gray-700 uppercase">In this article</h2><div class="my-2 w-24 h-0.5 bg-primary"></div><ul class="text-sm"><li><a class="block py-1 transform transition-colors duration-200 text-gray-500 hover:text-gray-800 hover:no-underline" href="#introduction">Introduction</a></li><li><a class="block py-1 transform transition-colors duration-200 text-gray-500 hover:text-gray-800 hover:no-underline" href="#definingterms">Defining Terms</a></li><li><a class="block py-1 transform transition-colors duration-200 text-gray-500 hover:text-gray-800 hover:no-underline" href="#theorybehindminimax">Theory Behind Minimax</a></li><li><a class="block py-1 transform transition-colors duration-200 text-gray-500 hover:text-gray-800 hover:no-underline" href="#openingbooksandtictactoe">Opening Books and Tic-Tac-Toe</a></li><li><a class="block py-1 transform transition-colors duration-200 text-gray-500 hover:text-gray-800 hover:no-underline" href="#minimaximplementationinpython">Minimax Implementation in Python</a></li><li><a class="block py-1 transform transition-colors duration-200 text-gray-500 hover:text-gray-800 hover:no-underline" href="#alphabetapruning">Alpha-Beta Pruning</a></li><li><a class="block py-1 transform transition-colors duration-200 text-gray-500 hover:text-gray-800 hover:no-underline" href="#conclusion">Conclusion</a></li></ul></div><div class="py-4"><div class="bg-white px-5 py-3 rounded border border-gray-300"><h2 class="mt-2 mb-4 text-xl leading-4 font-extrabold text-gray-700">Want a remote job?</h2><div class="my-4 w-24 h-1 bg-primary"></div><ul class="text-sm divide-y divide-gray-200"></ul><div class="mt-3 flex justify-between items-center"><a href="https://hireremote.io" rel="noopener nofollow noreferrer" target="_blank" class="inline-flex items-center justify-center px-2 py-1 border border-transparent text-sm leading-5 font-medium rounded-sm shadow hover:bg-orange-400 hover:no-underline focus:outline-none focus:ring transition duration-150 ease-in-out" style="background-color:#f16334" ga-on="click" ga-event-category="Jobs" ga-event-action="Click" ga-event-label="HR-More-Link"><span class="inline-flex items-center text-white"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 9l3 3m0 0l-3 3m3-3H8m13 0a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>¬† More Jobs</span></a><div style="font-size:12px">Jobs by<a rel="noopener nofollow noreferrer" target="_blank" href="https://hireremote.io" class="hr-link ml-1">HireRemote.io</a></div></div></div></div><div class="py-4"><div class=" my-4 flex justify-center" style="min-height:250px"><div id="waldo-tag-7184"></div></div></div><div class="py-4"><div class="bg-white px-6 py-3 rounded border border-gray-300"><h2 class="mt-2 mb-4 text-xl leading-4 font-extrabold text-gray-700">Prepping for an interview?</h2><div class="my-4 w-24 h-1 bg-primary"></div><ul class="pt-4 text-sm"><li>Improve your skills by solving one coding problem every day</li><li class="pt-4">Get the solutions the next morning via email</li><li class="pt-4">Practice on <strong>actual problems</strong> asked by top companies, like:</li></ul><div class="my-8 flex justify-between"><div class="lazyload-wrapper "><div style="height:16px" class="lazyload-placeholder"></div></div>¬†<div class="lazyload-wrapper "><div style="height:13px" class="lazyload-placeholder"></div></div>¬†<div class="lazyload-wrapper "><div style="height:19px" class="lazyload-placeholder"></div></div>¬†<div class="lazyload-wrapper "><div style="height:18px" class="lazyload-placeholder"></div></div></div><div class="mt-3"><a href="https://stackabu.se/daily-coding-problem" class="dcp-link inline-flex items-center justify-center px-3 py-1 border border-transparent text-sm leading-6 font-medium rounded-sm shadow hover:bg-orange-400 hover:no-underline focus:outline-none focus:ring transition duration-150 ease-in-out" style="background-color:#f16334"><span class="inline-flex items-center text-white"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 9l3 3-3 3m5 0h3M5 20h14a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>¬† Daily Coding Problem</span></a></div></div></div><div class="py-4"><div class="bg-white px-6 py-3 rounded border border-gray-300"><h2 class="mt-2 mb-4 text-xl leading-4 font-extrabold text-gray-700">Better understand your data with visualizations</h2><div class="my-4 w-24 h-1 bg-primary"></div><a class="ebook-link" href="https://gum.co/data-visualization-in-python"><div class="lazyload-wrapper "><div style="height:300px" class="lazyload-placeholder"></div></div></a><div><p class="my-6 max-w-3xl text-md leading-6 text-gray-500">With over 330+ pages, you'll learn the ins and outs of visualizing data in Python with popular libraries like Matplotlib, Seaborn, Bokeh, and more.</p></div><div class="mt-3"><a href="https://gum.co/data-visualization-in-python" class="ebook-link inline-flex items-center justify-center px-3 py-1 border border-transparent text-sm leading-6 font-medium rounded-sm shadow hover:bg-orange-400 hover:no-underline focus:outline-none focus:ring transition duration-150 ease-in-out" style="background-color:#f16334"><span class="inline-flex items-center text-white">Learn more ¬†<svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></span></a></div></div></div><div class="py-4 sticky top-0"><div class=""><div class=" my-4 flex justify-center" style="min-height:250px"><div id="waldo-tag-7611"></div></div></div></div></div></div></div></main><div class="bg-white border-t border-gray-300"><div class="max-w-screen-xl mx-auto pt-12 pb-6 px-4 sm:px-6 md:flex md:items-center md:justify-between lg:px-8"><div class="flex justify-center md:order-2"><a href="https://twitter.com/stackabuse" target="_blank" rel="noreferrer noopener" class="text-gray-500 hover:text-twitter"><span class="sr-only">Twitter</span><svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84"></path></svg></a><a href="https://github.com/stackabuse" target="_blank" rel="noreferrer noopener" class="ml-6 text-gray-500 hover:text-github"><span class="sr-only">GitHub</span><svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd"></path></svg></a><a href="https://www.facebook.com/stackabuse" target="_blank" rel="noreferrer noopener" class="ml-6 text-gray-500 hover:text-facebook"><span class="sr-only">Facebook</span><svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.988C18.343 21.128 22 16.991 22 12z" clip-rule="evenodd"></path></svg></a></div><div class="mt-8 md:mt-0 md:order-1"><p class="text-center text-base leading-6 text-gray-500">¬© 2013-<!-- -->2021<!-- --> Stack Abuse. All rights reserved.</p><div class="text-sm"><a class="pr-4 text-gray-500 border-r-2 border-grey-400 hover:no-underline hover:text-gray-600" href="/disclosure/">Disclosure</a><a class="px-4 text-gray-500 border-r-2 border-grey-400 hover:no-underline hover:text-gray-600" href="/privacy-policy/">Privacy</a><a class="pl-4 text-gray-500 hover:no-underline hover:text-gray-600" href="/terms-of-service/">Terms</a></div></div></div></div></div><script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"content":{"id":490,"title":"Minimax with Alpha-Beta Pruning in Python","slug":"minimax-and-alpha-beta-pruning-in-python","body_html":"\u003ch3 id=\"introduction\"\u003eIntroduction\u003c/h3\u003e\n\u003cp\u003eWay back in the late 1920s \u003ca rel=\"nofollow\" target=\"_blank\" href=\"https://en.wikipedia.org/wiki/John_von_Neumann\"\u003eJohn Von Neumann\u003c/a\u003e established the main problem in game theory that has remained relevant still today:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003ePlayers s\u003csub\u003e1\u003c/sub\u003e, s\u003csub\u003e2\u003c/sub\u003e, ..., s\u003csub\u003en\u003c/sub\u003e are playing a given game G. Which moves should player s\u003csub\u003em\u003c/sub\u003e play to achieve the best possible outcome?\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eShortly after, problems of this kind grew into a challenge of great significance for development of one of today's most popular fields in computer science - artificial intelligence. Some of the greatest accomplishments in artificial intelligence are achieved on the subject of strategic games - world champions in various strategic games have already been beaten by computers, e.g. in Chess, Checkers, Backgammon, and most recently (2016) even Go.\u003c/p\u003e\n\u003cp\u003eAlthough these programs are very successful, their way of making decisions is a lot different than that of humans. The majority of these programs are based on efficient \u003ca target=\"_blank\" href=\"/search-algorithms-in-python\"\u003esearching algorithms\u003c/a\u003e, and since recently on machine learning as well.\u003c/p\u003e\n\u003cp\u003eThe \u003ca rel=\"nofollow\" target=\"_blank\" href=\"https://en.wikipedia.org/wiki/Minimax\"\u003eMinimax algorithm\u003c/a\u003e is a relatively simple algorithm used for optimal decision-making in game theory and artificial intelligence. Again, since these algorithms heavily rely on being efficient, the vanilla algorithm's performance can be heavily improved by using alpha-beta pruning - we'll cover both in this article.\u003c/p\u003e\n\u003cp\u003eAlthough we won't analyze each game individually, we'll briefly explain some general concepts that are relevant for two-player \u003ca rel=\"nofollow\" target=\"_blank\" href=\"https://en.wikipedia.org/wiki/Non-cooperative_game_theory\"\u003enon-cooperative\u003c/a\u003e \u003ca rel=\"nofollow\" target=\"_blank\" href=\"https://en.wikipedia.org/wiki/Zero-sum_game\"\u003ezero-sum\u003c/a\u003e \u003ca rel=\"nofollow\" target=\"_blank\" href=\"https://en.wikipedia.org/wiki/Symmetric_game\"\u003esymmetrical\u003c/a\u003e games with \u003ca rel=\"nofollow\" target=\"_blank\" href=\"https://en.wikipedia.org/wiki/Perfect_information\"\u003eperfect information\u003c/a\u003e - Chess, Go, Tic-Tac-Toe, Backgammon, Reversi, Checkers, Mancala, 4 in a row etc...\u003c/p\u003e\n\u003cp\u003eAs you probably noticed, none of these games are ones where e.g. a player doesn't know which cards the opponent has, or where a player needs to guess about certain information.\u003c/p\u003e\n\u003ch3 id=\"definingterms\"\u003eDefining Terms\u003c/h3\u003e\n\u003cp\u003eRules of many of these games are defined by \u003cem\u003elegal positions\u003c/em\u003e (or \u003cem\u003elegal states\u003c/em\u003e) and \u003cem\u003elegal moves\u003c/em\u003e for every legal position. For every legal position it is possible to effectively determine all the legal moves. Some of the legal positions are \u003cem\u003estarting positions\u003c/em\u003e and some are \u003cem\u003eending positions\u003c/em\u003e.\u003c/p\u003e\n\u003cp\u003eThe best way to describe these terms is using a tree graph whose nodes are legal positions and whose edges are legal moves. The graph is directed since it does not necessarily mean that we'll be able to move back exactly where we came from in the previous move, e.g. in chess a pawn can only go forward. This graph is called a \u003cem\u003egame tree\u003c/em\u003e. Moving down the game tree represents one of the players making a move, and the game state changing from one legal position to another.\u003c/p\u003e\n\u003cp\u003eHere's an illustration of a game tree for a tic-tac-toe game:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://stackabuse.s3.amazonaws.com/media/minimax-and-alpha-beta-pruning-in-python-1.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eGrids colored blue are player X's turns, and grids colored red are player O's turns. The ending position (leaf of the tree) is any grid where one of the players won or the board is full and there's no winner.\u003c/p\u003e\n\u003cp\u003eThe \u003cem\u003ecomplete game tree\u003c/em\u003e is a game tree whose root is starting position, and all the leaves are ending positions. Each complete game tree has as many nodes as the game has possible outcomes for every legal move made. It is easy to notice that even for small games like tic-tac-toe the complete game tree is huge. For that reason it is not a good practice to explicitly create a whole game tree as a structure while writing a program that is supposed to predict the best move at any moment. Yet, the nodes should be created implicitly in the process of visiting.\u003c/p\u003e\n\u003cp\u003eWe'll define \u003cem\u003estate-space complexity of a game\u003c/em\u003e as a number of legal game positions reachable from the starting position of the game, and \u003cem\u003ebranching factor\u003c/em\u003e as the number of children at each node (if that number isn't constant, it's a common practice to use an average).\u003c/p\u003e\n\u003cp\u003eFor tic-tac-toe, an upper bound for the size of the state space is 3\u003csup\u003e9\u003c/sup\u003e=19683. Imagine that number for games like chess! Hence, searching through whole tree to find out what's our best move whenever we take turn would be super inefficient and slow.\u003c/p\u003e\n\u003cp\u003eThis is why Minimax is of such a great significance in game theory.\u003c/p\u003e\n\u003ch3 id=\"theorybehindminimax\"\u003eTheory Behind Minimax\u003c/h3\u003e\n\u003cp\u003eThe Minimax algorithm relies on systematic searching, or more accurately said - on \u003cstrong\u003ebrute force\u003c/strong\u003e and a simple evaluation function. Let's assume that every time during deciding the next move we search through a whole tree, all the way down to leaves. Effectively we would look into all the possible outcomes and every time we would be able to determine the best possible move.\u003c/p\u003e\n\u003cp\u003eHowever, for non-trivial games, that practice is inapplicable. Even searching to a certain depth sometimes takes an unacceptable amount of time. Therefore, Minimax applies search to a fairly low tree depth aided with appropriate \u003ca rel=\"nofollow\" target=\"_blank\" href=\"https://en.wikipedia.org/wiki/Heuristic\"\u003eheuristics\u003c/a\u003e, and a well designed, yet simple \u003cem\u003eevaluation function\u003c/em\u003e.\u003c/p\u003e\n\u003cp\u003eWith this approach we lose the certainty in finding the best possible move, but the majority of cases the decision that minimax makes is much better than any human's.\u003c/p\u003e\n\u003cp\u003eNow, let's take a closer look at the evaluation function we've previously mentioned. In order to determine a good (not necessarily the best) move for a certain player, we have to somehow evaluate nodes (positions) to be able to compare one to another by quality.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThe evaluation function is a static number, that in accordance with the characteristics of the game itself, is being assigned to each node (position).\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eIt is important to mention that the evaluation function must not rely on the search of previous nodes, nor of the following. It should simply analyze the game state and circumstances that both players are in.\u003c/p\u003e\n\u003cp\u003eIt is necessary that the evaluation function contains as much relevant information as possible, but on the other hand - since it's being calculated \u003cstrong\u003emany\u003c/strong\u003e times - it needs to be simple.\u003c/p\u003e\n\u003cp\u003eUsually it maps the set of all possible positions into symmetrical segment:\u003c/p\u003e\n\u003cp\u003e$$\u003cbr\u003e\n\\mathcal{F} : \\mathcal{P} \\rightarrow [-M, M]\u003cbr\u003e\n$$\u003c/p\u003e\n\u003cp\u003eValue of \u003ccode\u003eM\u003c/code\u003e is being assigned only to leaves where the winner is the first player, and value \u003ccode\u003e-M\u003c/code\u003e to leaves where the winner is the second player.\u003c/p\u003e\n\u003cp\u003eIn zero-sum games, the value of the evaluation function has an opposite meaning - what's better for the first player is worse for the second, and vice versa. Hence, the value for symmetric positions (if players switch roles) should be different only by sign.\u003c/p\u003e\n\u003cp\u003eA common practice is to modify evaluations of leaves by subtracting the depth of that exact leaf, so that out of all moves that lead to victory the algorithm can pick the one that does it in the smallest number of steps (or picks the move that postpones loss if it is inevitable).\u003c/p\u003e\n\u003cp\u003eHere's a simple illustration of Minimax' steps. We're looking for the minimum value, in this case.\u003c/p\u003e\n\u003cp\u003eThe green layer calls the \u003ccode\u003eMax()\u003c/code\u003e method on nodes in the child nodes and the red layer calls the \u003ccode\u003eMin()\u003c/code\u003e method on child nodes.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eEvaluating leaves:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003cimg src=\"https://stackabuse.s3.amazonaws.com/media/minimax-and-alpha-beta-pruning-in-python-2.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003eDeciding the best move for green player using depth 3:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003cimg src=\"https://stackabuse.s3.amazonaws.com/media/minimax-and-alpha-beta-pruning-in-python-3.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eThe idea is to find the best possible move for a given node, depth, and evaluation function.\u003c/p\u003e\n\u003cp\u003eIn this example we've assumed that the green player seeks positive values, while the pink player seeks negative. The algorithm primarily evaluates only nodes at the given depth, and the rest of the procedure is \u003ca rel=\"nofollow\" target=\"_blank\" href=\"https://en.wikipedia.org/wiki/Recursion_(computer_science)\"\u003erecursive\u003c/a\u003e. The values of the rest of the nodes are the maximum values of their respective children if it's green player's turn, or, analogously, the minimum value if it's pink player's turn. The value in each node represents the next best move considering given information.\u003c/p\u003e\n\u003cp\u003eWhile searching the game tree, we're examining only nodes on a fixed (given) depth, not the ones before, nor after. This phenomenon is often called \u003ca rel=\"nofollow\" target=\"_blank\" href=\"https://en.wikipedia.org/wiki/Horizon_effect\"\u003ethe horizon effect\u003c/a\u003e.\u003c/p\u003e\n\u003ch3 id=\"openingbooksandtictactoe\"\u003eOpening Books and Tic-Tac-Toe\u003c/h3\u003e\n\u003cp\u003eIn strategic games, instead of letting the program start the searching process in the very beginning of the game, it is common to use the \u003cem\u003eopening books\u003c/em\u003e - a list of known and productive moves that are frequent and known to be productive while we still don't have much information about the state of game itself if we look at the board.\u003c/p\u003e\n\u003cp\u003eIn the beginning, it is too early in the game, and the number of potential positions is too great to automatically decide which move will certainly lead to a better game state (or win).\u003c/p\u003e\n\u003cp\u003eHowever, the algorithm reevaluates the next potential moves every turn, always choosing what at that moment appears to be the fastest route to victory. Therefore, it won't execute actions that take more than one move to complete, and is unable to perform certain well known \u0026quot;tricks\u0026quot; because of that. If the AI plays against a human, it is very likely that human will immediately be able to prevent this.\u003c/p\u003e\n\u003cp\u003eIf, on the other hand, we take a look at chess, we'll quickly realize the impracticality of solving chess by brute forcing through a whole game tree. To demonstrate this, \u003ca rel=\"nofollow\" target=\"_blank\" href=\"https://en.wikipedia.org/wiki/Claude_Shannon\"\u003eClaude Shannon\u003c/a\u003e calculated the lower bound of the game-tree complexity of chess, resulting in about \u003cstrong\u003e10\u003csup\u003e120\u003c/sup\u003e possible games\u003c/strong\u003e.\u003c/p\u003e\n\u003cp\u003eJust how big is that number? For reference, if we compared the mass of an electron (10\u003csup\u003e-30\u003c/sup\u003ekg) to the mass of the \u003cem\u003eentire known universe\u003c/em\u003e (10\u003csup\u003e50\u003c/sup\u003e-10\u003csup\u003e60\u003c/sup\u003ekg), the ratio would be in order of 10\u003csup\u003e80\u003c/sup\u003e-10\u003csup\u003e90\u003c/sup\u003e.\u003c/p\u003e\n\u003cp\u003eThat's ~0.0000000000000000000000000000000001% of the Shannon number.\u003c/p\u003e\n\u003cp\u003eImagine tasking an algorithm to go through \u003cem\u003eevery single\u003c/em\u003e of those combinations just to make a single decision. It's practically impossible to do.\u003c/p\u003e\n\u003cp\u003eEven after 10 moves, the number of possible games is tremendously huge:\u003c/p\u003e\n\u003ctable class=\"table table-striped\" style=\"white-space:nowrap; font-size:15px;\"\u003e\n  \u003ctr\u003e\n    \u003cth\u003eNumber of moves\u003c/th\u003e\n    \u003cth\u003eNumber of possible games\u003c/th\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003ctd\u003e1\u003c/td\u003e\n    \u003ctd\u003e20\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003ctd\u003e2\u003c/td\u003e\n    \u003ctd\u003e40\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003ctd\u003e3\u003c/td\u003e\n    \u003ctd\u003e8,902\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003ctd\u003e4\u003c/td\u003e\n    \u003ctd\u003e197,281\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003ctd\u003e5\u003c/td\u003e\n    \u003ctd\u003e4,865,609\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003ctd\u003e6\u003c/td\u003e\n    \u003ctd\u003e119,060,324\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003ctd\u003e7\u003c/td\u003e\n    \u003ctd\u003e3,195,901,860\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003ctd\u003e8\u003c/td\u003e\n    \u003ctd\u003e84,998,978,956\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003ctd\u003e9\u003c/td\u003e\n    \u003ctd\u003e2,439,530,234,167\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003ctd\u003e10\u003c/td\u003e\n    \u003ctd\u003e69,352,859,712,417\u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/table\u003e\n\u003cp\u003eLet's take this example to a tic-tac-toe game. As you probably already know, the most famous strategy of player X is to start in any of the corners, which gives the player O the most opportunities to make a mistake. If player O plays anything besides center and X continues his initial strategy, it's a guaranteed win for X. Opening books are exactly this - some nice ways to trick an opponent in the very beginning to get advantage, or in best case, a win.\u003c/p\u003e\n\u003cp\u003eTo simplify the code and get to the core of algorithm, in the example in the next chapter we won't bother using opening books or any mind tricks. We'll let the minimax search from the start, so don't be surprised that algorithm never recommends the corner strategy.\u003c/p\u003e\n\u003ch3 id=\"minimaximplementationinpython\"\u003eMinimax Implementation in Python\u003c/h3\u003e\n\u003cp\u003eIn the code below, we will be using an evaluation function that is fairly simple and common for all games in which it's possible to search the whole tree, all the way down to leaves.\u003c/p\u003e\n\u003cp\u003eIt has 3 possible values:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e-1 if player that seeks minimum wins\u003c/li\u003e\n\u003cli\u003e0 if it's a tie\u003c/li\u003e\n\u003cli\u003e1 if player that seeks maximum wins\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eSince we'll be implementing this through a tic-tac-toe game, let's go through the building blocks. First, let's make a constructor and draw out the board:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs\"\u003e\u003cspan class=\"hljs-comment\"\u003e# We\u0026#x27;ll use the time module to measure the time of evaluating\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# game tree in every move. It\u0026#x27;s a nice way to show the\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# distinction between the basic Minimax and Minimax with\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e# alpha-beta pruning :)\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e time\n\n\u003cspan class=\"hljs-class\"\u003e\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eGame\u003c/span\u003e:\u003c/span\u003e\n    \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003e__init__\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eself\u003c/span\u003e):\u003c/span\u003e\n        self.initialize_game()\n\n    \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003einitialize_game\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eself\u003c/span\u003e):\u003c/span\u003e\n        self.current_state = [[\u003cspan class=\"hljs-string\"\u003e\u0026#x27;.\u0026#x27;\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\u0026#x27;.\u0026#x27;\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\u0026#x27;.\u0026#x27;\u003c/span\u003e],\n                              [\u003cspan class=\"hljs-string\"\u003e\u0026#x27;.\u0026#x27;\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\u0026#x27;.\u0026#x27;\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\u0026#x27;.\u0026#x27;\u003c/span\u003e],\n                              [\u003cspan class=\"hljs-string\"\u003e\u0026#x27;.\u0026#x27;\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\u0026#x27;.\u0026#x27;\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\u0026#x27;.\u0026#x27;\u003c/span\u003e]]\n\n        \u003cspan class=\"hljs-comment\"\u003e# Player X always plays first\u003c/span\u003e\n        self.player_turn = \u003cspan class=\"hljs-string\"\u003e\u0026#x27;X\u0026#x27;\u003c/span\u003e\n\n    \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003edraw_board\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eself\u003c/span\u003e):\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e i \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003erange\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e):\n            \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e j \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003erange\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e):\n                print(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;{}|\u0026#x27;\u003c/span\u003e.\u003cspan class=\"hljs-built_in\"\u003eformat\u003c/span\u003e(self.current_state[i][j]), end=\u003cspan class=\"hljs-string\"\u003e\u0026quot; \u0026quot;\u003c/span\u003e)\n            print()\n        print()\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWe've talked about \u003cem\u003elegal moves\u003c/em\u003e in the beginning sections of the article. To make sure we abide by the rules, we need a way to check if a move is legal:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs\"\u003e\u003cspan class=\"hljs-comment\"\u003e# Determines if the made move is a legal move\u003c/span\u003e\n\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eis_valid\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eself, px, py\u003c/span\u003e):\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e px \u0026lt; \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eor\u003c/span\u003e px \u0026gt; \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eor\u003c/span\u003e py \u0026lt; \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eor\u003c/span\u003e py \u0026gt; \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e:\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eelif\u003c/span\u003e self.current_state[px][py] != \u003cspan class=\"hljs-string\"\u003e\u0026#x27;.\u0026#x27;\u003c/span\u003e:\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003eFalse\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e:\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThen, we need a simple way to check if the game has ended. In tic-tac-toe, a player can win by connecting three consecutive symbols in either a horizontal, diagonal or vertical line:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs\"\u003e\u003cspan class=\"hljs-comment\"\u003e# Checks if the game has ended and returns the winner in each case\u003c/span\u003e\n\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eis_end\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eself\u003c/span\u003e):\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e# Vertical win\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e i \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003erange\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e):\n        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (self.current_state[\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e][i] != \u003cspan class=\"hljs-string\"\u003e\u0026#x27;.\u0026#x27;\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e\n            self.current_state[\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e][i] == self.current_state[\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e][i] \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e\n            self.current_state[\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e][i] == self.current_state[\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e][i]):\n            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e self.current_state[\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e][i]\n\n    \u003cspan class=\"hljs-comment\"\u003e# Horizontal win\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e i \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003erange\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e):\n        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (self.current_state[i] == [\u003cspan class=\"hljs-string\"\u003e\u0026#x27;X\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;X\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;X\u0026#x27;\u003c/span\u003e]):\n            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;X\u0026#x27;\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003eelif\u003c/span\u003e (self.current_state[i] == [\u003cspan class=\"hljs-string\"\u003e\u0026#x27;O\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;O\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;O\u0026#x27;\u003c/span\u003e]):\n            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;O\u0026#x27;\u003c/span\u003e\n\n    \u003cspan class=\"hljs-comment\"\u003e# Main diagonal win\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (self.current_state[\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e][\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e] != \u003cspan class=\"hljs-string\"\u003e\u0026#x27;.\u0026#x27;\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e\n        self.current_state[\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e][\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e] == self.current_state[\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e][\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e] \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e\n        self.current_state[\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e][\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e] == self.current_state[\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e][\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e]):\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e self.current_state[\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e][\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e]\n\n    \u003cspan class=\"hljs-comment\"\u003e# Second diagonal win\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (self.current_state[\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e][\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e] != \u003cspan class=\"hljs-string\"\u003e\u0026#x27;.\u0026#x27;\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e\n        self.current_state[\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e][\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e] == self.current_state[\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e][\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e] \u003cspan class=\"hljs-keyword\"\u003eand\u003c/span\u003e\n        self.current_state[\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e][\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e] == self.current_state[\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e][\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e]):\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e self.current_state[\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e][\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e]\n\n    \u003cspan class=\"hljs-comment\"\u003e# Is whole board full?\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e i \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003erange\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e):\n        \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e j \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003erange\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e):\n            \u003cspan class=\"hljs-comment\"\u003e# There\u0026#x27;s an empty field, we continue the game\u003c/span\u003e\n            \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (self.current_state[i][j] == \u003cspan class=\"hljs-string\"\u003e\u0026#x27;.\u0026#x27;\u003c/span\u003e):\n                \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003eNone\u003c/span\u003e\n\n    \u003cspan class=\"hljs-comment\"\u003e# It\u0026#x27;s a tie!\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;.\u0026#x27;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe AI we play against is seeking two things - to maximize its own score and to minimize ours. To do that, we'll have a \u003ccode\u003emax()\u003c/code\u003e method that the AI uses for making optimal decisions.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs\"\u003e\u003cspan class=\"hljs-comment\"\u003e# Player \u0026#x27;O\u0026#x27; is max, in this case AI\u003c/span\u003e\n\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003emax\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eself\u003c/span\u003e):\u003c/span\u003e\n\n    \u003cspan class=\"hljs-comment\"\u003e# Possible values for maxv are:\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e# -1 - loss\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e# 0  - a tie\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e# 1  - win\u003c/span\u003e\n\n    \u003cspan class=\"hljs-comment\"\u003e# We\u0026#x27;re initially setting it to -2 as worse than the worst case:\u003c/span\u003e\n    maxv = -\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\n\n    px = \u003cspan class=\"hljs-literal\"\u003eNone\u003c/span\u003e\n    py = \u003cspan class=\"hljs-literal\"\u003eNone\u003c/span\u003e\n\n    result = self.is_end()\n\n    \u003cspan class=\"hljs-comment\"\u003e# If the game came to an end, the function needs to return\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e# the evaluation function of the end. That can be:\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e# -1 - loss\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e# 0  - a tie\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e# 1  - win\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e result == \u003cspan class=\"hljs-string\"\u003e\u0026#x27;X\u0026#x27;\u003c/span\u003e:\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e (-\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n    \u003cspan class=\"hljs-keyword\"\u003eelif\u003c/span\u003e result == \u003cspan class=\"hljs-string\"\u003e\u0026#x27;O\u0026#x27;\u003c/span\u003e:\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n    \u003cspan class=\"hljs-keyword\"\u003eelif\u003c/span\u003e result == \u003cspan class=\"hljs-string\"\u003e\u0026#x27;.\u0026#x27;\u003c/span\u003e:\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n\n    \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e i \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003erange\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e):\n        \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e j \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003erange\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e):\n            \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e self.current_state[i][j] == \u003cspan class=\"hljs-string\"\u003e\u0026#x27;.\u0026#x27;\u003c/span\u003e:\n                \u003cspan class=\"hljs-comment\"\u003e# On the empty field player \u0026#x27;O\u0026#x27; makes a move and calls Min\u003c/span\u003e\n                \u003cspan class=\"hljs-comment\"\u003e# That\u0026#x27;s one branch of the game tree.\u003c/span\u003e\n                self.current_state[i][j] = \u003cspan class=\"hljs-string\"\u003e\u0026#x27;O\u0026#x27;\u003c/span\u003e\n                (m, min_i, min_j) = self.\u003cspan class=\"hljs-built_in\"\u003emin\u003c/span\u003e()\n                \u003cspan class=\"hljs-comment\"\u003e# Fixing the maxv value if needed\u003c/span\u003e\n                \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e m \u0026gt; maxv:\n                    maxv = m\n                    px = i\n                    py = j\n                \u003cspan class=\"hljs-comment\"\u003e# Setting back the field to empty\u003c/span\u003e\n                self.current_state[i][j] = \u003cspan class=\"hljs-string\"\u003e\u0026#x27;.\u0026#x27;\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e (maxv, px, py)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eHowever, we will also include a \u003ccode\u003emin()\u003c/code\u003e method that will serve as a helper for us to minimize the AI's score:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs\"\u003e\u003cspan class=\"hljs-comment\"\u003e# Player \u0026#x27;X\u0026#x27; is min, in this case human\u003c/span\u003e\n\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003emin\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eself\u003c/span\u003e):\u003c/span\u003e\n\n    \u003cspan class=\"hljs-comment\"\u003e# Possible values for minv are:\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e# -1 - win\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e# 0  - a tie\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e# 1  - loss\u003c/span\u003e\n\n    \u003cspan class=\"hljs-comment\"\u003e# We\u0026#x27;re initially setting it to 2 as worse than the worst case:\u003c/span\u003e\n    minv = \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\n\n    qx = \u003cspan class=\"hljs-literal\"\u003eNone\u003c/span\u003e\n    qy = \u003cspan class=\"hljs-literal\"\u003eNone\u003c/span\u003e\n\n    result = self.is_end()\n\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e result == \u003cspan class=\"hljs-string\"\u003e\u0026#x27;X\u0026#x27;\u003c/span\u003e:\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e (-\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n    \u003cspan class=\"hljs-keyword\"\u003eelif\u003c/span\u003e result == \u003cspan class=\"hljs-string\"\u003e\u0026#x27;O\u0026#x27;\u003c/span\u003e:\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n    \u003cspan class=\"hljs-keyword\"\u003eelif\u003c/span\u003e result == \u003cspan class=\"hljs-string\"\u003e\u0026#x27;.\u0026#x27;\u003c/span\u003e:\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n\n    \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e i \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003erange\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e):\n        \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e j \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003erange\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e):\n            \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e self.current_state[i][j] == \u003cspan class=\"hljs-string\"\u003e\u0026#x27;.\u0026#x27;\u003c/span\u003e:\n                self.current_state[i][j] = \u003cspan class=\"hljs-string\"\u003e\u0026#x27;X\u0026#x27;\u003c/span\u003e\n                (m, max_i, max_j) = self.\u003cspan class=\"hljs-built_in\"\u003emax\u003c/span\u003e()\n                \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e m \u0026lt; minv:\n                    minv = m\n                    qx = i\n                    qy = j\n                self.current_state[i][j] = \u003cspan class=\"hljs-string\"\u003e\u0026#x27;.\u0026#x27;\u003c/span\u003e\n\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e (minv, qx, qy)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAnd ultimately, let's make a game loop that allows us to play against the AI:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs\"\u003e\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eplay\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eself\u003c/span\u003e):\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003ewhile\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e:\n        self.draw_board()\n        self.result = self.is_end()\n\n        \u003cspan class=\"hljs-comment\"\u003e# Printing the appropriate message if the game has ended\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e self.result != \u003cspan class=\"hljs-literal\"\u003eNone\u003c/span\u003e:\n            \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e self.result == \u003cspan class=\"hljs-string\"\u003e\u0026#x27;X\u0026#x27;\u003c/span\u003e:\n                print(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;The winner is X!\u0026#x27;\u003c/span\u003e)\n            \u003cspan class=\"hljs-keyword\"\u003eelif\u003c/span\u003e self.result == \u003cspan class=\"hljs-string\"\u003e\u0026#x27;O\u0026#x27;\u003c/span\u003e:\n                print(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;The winner is O!\u0026#x27;\u003c/span\u003e)\n            \u003cspan class=\"hljs-keyword\"\u003eelif\u003c/span\u003e self.result == \u003cspan class=\"hljs-string\"\u003e\u0026#x27;.\u0026#x27;\u003c/span\u003e:\n                print(\u003cspan class=\"hljs-string\"\u003e\u0026quot;It\u0026#x27;s a tie!\u0026quot;\u003c/span\u003e)\n\n            self.initialize_game()\n            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e\n\n        \u003cspan class=\"hljs-comment\"\u003e# If it\u0026#x27;s player\u0026#x27;s turn\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e self.player_turn == \u003cspan class=\"hljs-string\"\u003e\u0026#x27;X\u0026#x27;\u003c/span\u003e:\n\n            \u003cspan class=\"hljs-keyword\"\u003ewhile\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e:\n\n                start = time.time()\n                (m, qx, qy) = self.\u003cspan class=\"hljs-built_in\"\u003emin\u003c/span\u003e()\n                end = time.time()\n                print(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;Evaluation time: {}s\u0026#x27;\u003c/span\u003e.\u003cspan class=\"hljs-built_in\"\u003eformat\u003c/span\u003e(\u003cspan class=\"hljs-built_in\"\u003eround\u003c/span\u003e(end - start, \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e)))\n                print(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;Recommended move: X = {}, Y = {}\u0026#x27;\u003c/span\u003e.\u003cspan class=\"hljs-built_in\"\u003eformat\u003c/span\u003e(qx, qy))\n\n                px = \u003cspan class=\"hljs-built_in\"\u003eint\u003c/span\u003e(\u003cspan class=\"hljs-built_in\"\u003einput\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;Insert the X coordinate: \u0026#x27;\u003c/span\u003e))\n                py = \u003cspan class=\"hljs-built_in\"\u003eint\u003c/span\u003e(\u003cspan class=\"hljs-built_in\"\u003einput\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;Insert the Y coordinate: \u0026#x27;\u003c/span\u003e))\n\n                (qx, qy) = (px, py)\n\n                \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e self.is_valid(px, py):\n                    self.current_state[px][py] = \u003cspan class=\"hljs-string\"\u003e\u0026#x27;X\u0026#x27;\u003c/span\u003e\n                    self.player_turn = \u003cspan class=\"hljs-string\"\u003e\u0026#x27;O\u0026#x27;\u003c/span\u003e\n                    \u003cspan class=\"hljs-keyword\"\u003ebreak\u003c/span\u003e\n                \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e:\n                    print(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;The move is not valid! Try again.\u0026#x27;\u003c/span\u003e)\n\n        \u003cspan class=\"hljs-comment\"\u003e# If it\u0026#x27;s AI\u0026#x27;s turn\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e:\n            (m, px, py) = self.\u003cspan class=\"hljs-built_in\"\u003emax\u003c/span\u003e()\n            self.current_state[px][py] = \u003cspan class=\"hljs-string\"\u003e\u0026#x27;O\u0026#x27;\u003c/span\u003e\n            self.player_turn = \u003cspan class=\"hljs-string\"\u003e\u0026#x27;X\u0026#x27;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eLet's start the game!\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs\"\u003e\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003emain\u003c/span\u003e():\u003c/span\u003e\n    g = Game()\n    g.play()\n\n\u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e __name__ == \u003cspan class=\"hljs-string\"\u003e\u0026quot;__main__\u0026quot;\u003c/span\u003e:\n    main()\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eNow we'll take a look at what happens when we follow the recommended sequence of turns - i.e. we play optimally:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs\"\u003e.| .| .|\n.| .| .|\n.| .| .|\n\nEvaluation time: 5.0726919s\nRecommended move: X = 0, Y = 0\nInsert the X coordinate: 0\nInsert the Y coordinate: 0\nX| .| .|\n.| .| .|\n.| .| .|\n\nX| .| .|\n.| O| .|\n.| .| .|\n\nEvaluation time: 0.06496s\nRecommended move: X = 0, Y = 1\nInsert the X coordinate: 0\nInsert the Y coordinate: 1\nX| X| .|\n.| O| .|\n.| .| .|\n\nX| X| O|\n.| O| .|\n.| .| .|\n\nEvaluation time: 0.0020001s\nRecommended move: X = 2, Y = 0\nInsert the X coordinate: 2\nInsert the Y coordinate: 0\nX| X| O|\n.| O| .|\nX| .| .|\n\nX| X| O|\nO| O| .|\nX| .| .|\n\nEvaluation time: 0.0s\nRecommended move: X = 1, Y = 2\nInsert the X coordinate: 1\nInsert the Y coordinate: 2\nX| X| O|\nO| O| X|\nX| .| .|\n\nX| X| O|\nO| O| X|\nX| O| .|\n\nEvaluation time: 0.0s\nRecommended move: X = 2, Y = 2\nInsert the X coordinate: 2\nInsert the Y coordinate: 2\nX| X| O|\nO| O| X|\nX| O| X|\n\nIt's a tie!\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAs you've noticed, winning against this kind of AI is impossible. If we assume that both player and AI are playing optimally, the game will always be a tie. Since the AI always plays optimally, if we slip up, we'll lose.\u003c/p\u003e\n\u003cp\u003eTake a close look at the evaluation time, as we will compare it to the next, improved version of the algorithm in the next example.\u003c/p\u003e\n\u003ch3 id=\"alphabetapruning\"\u003eAlpha-Beta Pruning\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eAlpha‚Äìbeta (ùõº‚àíùõΩ)\u003c/strong\u003e algorithm was discovered independently by a few researches in mid 1900s. Alpha‚Äìbeta is actually an improved minimax using a heuristic. It stops evaluating a move when it makes sure that it's worse than previously examined move. Such moves need not to be evaluated further.\u003c/p\u003e\n\u003cp\u003eWhen added to a simple minimax algorithm, it gives the same output, but cuts off certain branches that can't possibly affect the final decision - dramatically improving the performance.\u003c/p\u003e\n\u003cp\u003eThe main concept is to maintain two values through whole search:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eAlpha\u003c/strong\u003e: Best already explored option for player Max\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eBeta\u003c/strong\u003e: Best already explored option for player Min\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eInitially, alpha is negative infinity and beta is positive infinity, i.e. in our code we'll be using the worst possible scores for both players.\u003c/p\u003e\n\u003cp\u003eLet's see how the previous tree will look if we apply alpha-beta method:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://stackabuse.s3.amazonaws.com/media/minimax-and-alpha-beta-pruning-in-python-4.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eWhen the search comes to the first grey area (8), it'll check the current best (with minimum value) already explored option along the path for the minimizer, which is at that moment 7. Since 8 is bigger than 7, we are allowed to cut off all the further children of the node we're at (in this case there aren't any), since if we play that move, the opponent will play a move with value 8, which is worse for us than any possible move the opponent could have made if we had made another move.\u003c/p\u003e\n\u003cp\u003eA better example may be when it comes to a next grey. Note the nodes with value -9. At that point, the best (with maximum value) explored option along the path for the maximizer is -4. Since -9 is less than -4, we are able to cut off all the other children of the node we're at.\u003c/p\u003e\n\u003cp\u003eThis method allows us to ignore many branches that lead to values that won't be of any help for our decision, nor they would affect it in any way.\u003c/p\u003e\n\u003cp\u003eWith that in mind, let's modify the \u003ccode\u003emin()\u003c/code\u003e and \u003ccode\u003emax()\u003c/code\u003e methods from before:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs\"\u003e\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003emax_alpha_beta\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eself, alpha, beta\u003c/span\u003e):\u003c/span\u003e\n        maxv = -\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\n        px = \u003cspan class=\"hljs-literal\"\u003eNone\u003c/span\u003e\n        py = \u003cspan class=\"hljs-literal\"\u003eNone\u003c/span\u003e\n\n        result = self.is_end()\n\n        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e result == \u003cspan class=\"hljs-string\"\u003e\u0026#x27;X\u0026#x27;\u003c/span\u003e:\n            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e (-\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n        \u003cspan class=\"hljs-keyword\"\u003eelif\u003c/span\u003e result == \u003cspan class=\"hljs-string\"\u003e\u0026#x27;O\u0026#x27;\u003c/span\u003e:\n            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n        \u003cspan class=\"hljs-keyword\"\u003eelif\u003c/span\u003e result == \u003cspan class=\"hljs-string\"\u003e\u0026#x27;.\u0026#x27;\u003c/span\u003e:\n            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n\n        \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e i \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003erange\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e):\n            \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e j \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003erange\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e):\n                \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e self.current_state[i][j] == \u003cspan class=\"hljs-string\"\u003e\u0026#x27;.\u0026#x27;\u003c/span\u003e:\n                    self.current_state[i][j] = \u003cspan class=\"hljs-string\"\u003e\u0026#x27;O\u0026#x27;\u003c/span\u003e\n                    (m, min_i, in_j) = self.min_alpha_beta(alpha, beta)\n                    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e m \u0026gt; maxv:\n                        maxv = m\n                        px = i\n                        py = j\n                    self.current_state[i][j] = \u003cspan class=\"hljs-string\"\u003e\u0026#x27;.\u0026#x27;\u003c/span\u003e\n\n                    \u003cspan class=\"hljs-comment\"\u003e# Next two ifs in Max and Min are the only difference between regular algorithm and minimax\u003c/span\u003e\n                    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e maxv \u0026gt;= beta:\n                        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e (maxv, px, py)\n\n                    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e maxv \u0026gt; alpha:\n                        alpha = maxv\n\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e (maxv, px, py)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs\"\u003e \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003emin_alpha_beta\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eself, alpha, beta\u003c/span\u003e):\u003c/span\u003e\n\n        minv = \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\n\n        qx = \u003cspan class=\"hljs-literal\"\u003eNone\u003c/span\u003e\n        qy = \u003cspan class=\"hljs-literal\"\u003eNone\u003c/span\u003e\n\n        result = self.is_end()\n\n        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e result == \u003cspan class=\"hljs-string\"\u003e\u0026#x27;X\u0026#x27;\u003c/span\u003e:\n            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e (-\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n        \u003cspan class=\"hljs-keyword\"\u003eelif\u003c/span\u003e result == \u003cspan class=\"hljs-string\"\u003e\u0026#x27;O\u0026#x27;\u003c/span\u003e:\n            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n        \u003cspan class=\"hljs-keyword\"\u003eelif\u003c/span\u003e result == \u003cspan class=\"hljs-string\"\u003e\u0026#x27;.\u0026#x27;\u003c/span\u003e:\n            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n\n        \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e i \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003erange\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e):\n            \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e j \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003erange\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e):\n                \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e self.current_state[i][j] == \u003cspan class=\"hljs-string\"\u003e\u0026#x27;.\u0026#x27;\u003c/span\u003e:\n                    self.current_state[i][j] = \u003cspan class=\"hljs-string\"\u003e\u0026#x27;X\u0026#x27;\u003c/span\u003e\n                    (m, max_i, max_j) = self.max_alpha_beta(alpha, beta)\n                    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e m \u0026lt; minv:\n                        minv = m\n                        qx = i\n                        qy = j\n                    self.current_state[i][j] = \u003cspan class=\"hljs-string\"\u003e\u0026#x27;.\u0026#x27;\u003c/span\u003e\n\n                    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e minv \u0026lt;= alpha:\n                        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e (minv, qx, qy)\n\n                    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e minv \u0026lt; beta:\n                        beta = minv\n\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e (minv, qx, qy)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAnd now, the game loop:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs\"\u003e  \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eplay_alpha_beta\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eself\u003c/span\u003e):\u003c/span\u003e\n     \u003cspan class=\"hljs-keyword\"\u003ewhile\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e:\n        self.draw_board()\n        self.result = self.is_end()\n\n        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e self.result != \u003cspan class=\"hljs-literal\"\u003eNone\u003c/span\u003e:\n            \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e self.result == \u003cspan class=\"hljs-string\"\u003e\u0026#x27;X\u0026#x27;\u003c/span\u003e:\n                print(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;The winner is X!\u0026#x27;\u003c/span\u003e)\n            \u003cspan class=\"hljs-keyword\"\u003eelif\u003c/span\u003e self.result == \u003cspan class=\"hljs-string\"\u003e\u0026#x27;O\u0026#x27;\u003c/span\u003e:\n                print(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;The winner is O!\u0026#x27;\u003c/span\u003e)\n            \u003cspan class=\"hljs-keyword\"\u003eelif\u003c/span\u003e self.result == \u003cspan class=\"hljs-string\"\u003e\u0026#x27;.\u0026#x27;\u003c/span\u003e:\n                print(\u003cspan class=\"hljs-string\"\u003e\u0026quot;It\u0026#x27;s a tie!\u0026quot;\u003c/span\u003e)\n\n\n            self.initialize_game()\n            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e\n\n        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e self.player_turn == \u003cspan class=\"hljs-string\"\u003e\u0026#x27;X\u0026#x27;\u003c/span\u003e:\n\n            \u003cspan class=\"hljs-keyword\"\u003ewhile\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003eTrue\u003c/span\u003e:\n                start = time.time()\n                (m, qx, qy) = self.min_alpha_beta(-\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e)\n                end = time.time()\n                print(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;Evaluation time: {}s\u0026#x27;\u003c/span\u003e.\u003cspan class=\"hljs-built_in\"\u003eformat\u003c/span\u003e(\u003cspan class=\"hljs-built_in\"\u003eround\u003c/span\u003e(end - start, \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e)))\n                print(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;Recommended move: X = {}, Y = {}\u0026#x27;\u003c/span\u003e.\u003cspan class=\"hljs-built_in\"\u003eformat\u003c/span\u003e(qx, qy))\n\n                px = \u003cspan class=\"hljs-built_in\"\u003eint\u003c/span\u003e(\u003cspan class=\"hljs-built_in\"\u003einput\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;Insert the X coordinate: \u0026#x27;\u003c/span\u003e))\n                py = \u003cspan class=\"hljs-built_in\"\u003eint\u003c/span\u003e(\u003cspan class=\"hljs-built_in\"\u003einput\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;Insert the Y coordinate: \u0026#x27;\u003c/span\u003e))\n\n                qx = px\n                qy = py\n\n                \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e self.is_valid(px, py):\n                    self.current_state[px][py] = \u003cspan class=\"hljs-string\"\u003e\u0026#x27;X\u0026#x27;\u003c/span\u003e\n                    self.player_turn = \u003cspan class=\"hljs-string\"\u003e\u0026#x27;O\u0026#x27;\u003c/span\u003e\n                    \u003cspan class=\"hljs-keyword\"\u003ebreak\u003c/span\u003e\n                \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e:\n                    print(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;The move is not valid! Try again.\u0026#x27;\u003c/span\u003e)\n\n        \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e:\n            (m, px, py) = self.max_alpha_beta(-\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e)\n            self.current_state[px][py] = \u003cspan class=\"hljs-string\"\u003e\u0026#x27;O\u0026#x27;\u003c/span\u003e\n            self.player_turn = \u003cspan class=\"hljs-string\"\u003e\u0026#x27;X\u0026#x27;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ePlaying the game is the same as before, though if we take a look at the time it takes for the AI to find optimal solutions, there's a big difference:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs\"\u003e.| .| .|\n.| .| .|\n.| .| .|\n\nEvaluation time: 0.1688969s\nRecommended move: X = 0, Y = 0\n\n\nEvaluation time: 0.0069957s\nRecommended move: X = 0, Y = 1\n\n\nEvaluation time: 0.0009975s\nRecommended move: X = 2, Y = 0\n\n\nEvaluation time: 0.0s\nRecommended move: X = 1, Y = 2\n\n\nEvaluation time: 0.0s\nRecommended move: X = 2, Y = 2\n\nIt's a tie!\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAfter testing and starting the program from scratch for a few times, results for the comparison are in a table below:\u003c/p\u003e\n\u003ctable class=\"table table-striped\" style=\"white-space:nowrap; font-size:15px;\"\u003e\n  \u003ctr\u003e\n    \u003cth\u003eAlgorithm\u003c/th\u003e\n    \u003cth\u003eMinimum time\u003c/th\u003e\n    \u003cth\u003eMaximum time\u003c/th\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003ctd\u003eMinimax\u003c/td\u003e\n    \u003ctd\u003e4.57s\u003c/td\u003e\n    \u003ctd\u003e5.34s\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003ctd\u003eAlpha-beta pruning\u003c/td\u003e\n    \u003ctd\u003e0.16s\u003c/td\u003e\n    \u003ctd\u003e0.2s\u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/table\u003e\n\u003ch3 id=\"conclusion\"\u003eConclusion\u003c/h3\u003e\n\u003cp\u003eAlpha-beta pruning makes a major difference in evaluating large and complex game trees. Even though tic-tac-toe is a simple game itself, we can still notice how without alpha-beta heuristics the algorithm takes significantly more time to recommend the move in first turn.\u003c/p\u003e\n","parent_id":null,"type":"article","visibility":"public","img_feature":null,"is_featured":false,"locale":"en","custom_excerpt":null,"inject_header":null,"inject_footer":null,"canonical_url":null,"comment_id":"5d5d13af05f16e6a7271f87f","og_image":null,"og_title":null,"og_description":null,"twitter_image":null,"twitter_title":null,"twitter_description":null,"meta_title":null,"meta_description":null,"read_time_min":20,"published_at":1566822300000,"created_at":1566380975000,"updated_at":1566836282000,"contributors":[{"id":40,"name":"Mina Krivokuƒáa","slug":"minx","role_id":4,"img_profile":"//s3.stackabuse.com/media/users/7c916203e7c1ddff49eed8c7063b1164.jpg","img_cover":null,"bio_html":"","website":null,"location":"Belgrade","facebook":null,"twitter":null,"github":null,"created_at":1566401521000,"updated_at":1629840515997,"role":"author","is_email_confirmed":false,"_pivot_content_id":490,"_pivot_user_id":40,"_pivot_role":"author","_pivot_sort_order":0}],"tags":[{"id":9,"name":"python","slug":"python","img_cover":null,"description_html":"","og_image":null,"og_title":null,"og_description":null,"twitter_image":null,"twitter_title":null,"twitter_description":null,"meta_title":null,"meta_description":null,"inject_header":null,"inject_footer":null,"canonical_url":null,"color":null,"created_at":1431358631000,"updated_at":1431358631000,"_pivot_content_id":490,"_pivot_tag_id":9,"_pivot_sort_order":0},{"id":57,"name":"artificial intelligence","slug":"artificial-intelligence","img_cover":null,"description_html":"","og_image":null,"og_title":null,"og_description":null,"twitter_image":null,"twitter_title":null,"twitter_description":null,"meta_title":null,"meta_description":null,"inject_header":null,"inject_footer":null,"canonical_url":null,"color":null,"created_at":1442517465000,"updated_at":1442517465000,"_pivot_content_id":490,"_pivot_tag_id":57,"_pivot_sort_order":1},{"id":89,"name":"algorithms","slug":"algorithms","img_cover":null,"description_html":"","og_image":null,"og_title":null,"og_description":null,"twitter_image":null,"twitter_title":null,"twitter_description":null,"meta_title":null,"meta_description":null,"inject_header":null,"inject_footer":null,"canonical_url":null,"color":null,"created_at":1518452207000,"updated_at":1518452207000,"_pivot_content_id":490,"_pivot_tag_id":89,"_pivot_sort_order":3},{"id":145,"name":"game theory","slug":"game-theory","img_cover":null,"description_html":"","og_image":null,"og_title":null,"og_description":null,"twitter_image":null,"twitter_title":null,"twitter_description":null,"meta_title":null,"meta_description":null,"inject_header":null,"inject_footer":null,"canonical_url":null,"color":null,"created_at":1566577224000,"updated_at":1566577224000,"_pivot_content_id":490,"_pivot_tag_id":145,"_pivot_sort_order":2}]},"error":null,"isEU":false},"__N_SSP":true},"page":"/[slug]","query":{"slug":"minimax-and-alpha-beta-pruning-in-python"},"buildId":"1630443456288","isFallback":false,"gssp":true,"customServer":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-a76f4360280b7a18f57e.js"></script><script src="/_next/static/chunks/webpack-277c75ec70a3d22a400d.js" async=""></script><script src="/_next/static/chunks/framework-c8764b7c89156c961b8d.js" async=""></script><script src="/_next/static/chunks/main-518b48f042719025b17a.js" async=""></script><script src="/_next/static/chunks/pages/_app-9c13ffeead0b88cdb1b4.js" async=""></script><script src="/_next/static/chunks/3-fffb48dea4989f4d1391.js" async=""></script><script src="/_next/static/chunks/543-cb07b5fc2817d1fd9d2f.js" async=""></script><script src="/_next/static/chunks/638-590762dd8d0272f0797c.js" async=""></script><script src="/_next/static/chunks/677-73df68294d1ef6988d75.js" async=""></script><script src="/_next/static/chunks/566-946cc7c83528800c6af6.js" async=""></script><script src="/_next/static/chunks/221-fd1b1d9fc7fde140cafc.js" async=""></script><script src="/_next/static/chunks/489-460cf565e04b6b9db7ae.js" async=""></script><script src="/_next/static/chunks/458-83f6a55e72287e88ba6c.js" async=""></script><script src="/_next/static/chunks/917-3ebc564d49985eea0f5b.js" async=""></script><script src="/_next/static/chunks/pages/%5Bslug%5D-5a81b17152fa06d8cc4d.js" async=""></script><script src="/_next/static/1630443456288/_buildManifest.js" async=""></script><script src="/_next/static/1630443456288/_ssgManifest.js" async=""></script></body></html>